<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="sJgro_9-KyRL3EkTM5KW84pQPrg2Fv1KdkibDRBIulE">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"cloudolife.com","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.23.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="sync.Mutex &amp; sync.RWMutex Mutex and RWMutex are not associated with goroutines, but RWMutex is obviously more suitable for scenarios with more reads and less writes. For read performance only, RWM">
<meta property="og:type" content="article">
<meta property="og:title" content="[Golang (Go)] Use sync.Mutex, sync.RWMutex to lock share data for race condition">
<meta property="og:url" content="https://cloudolife.com/2020/04/18/Programming-Language/Golang-Go/Synchronization/Use-sync-Mutex-sync-RWMutex-to-lock-share-data-for-race-condition/index.html">
<meta property="og:site_name" content="Cloud-oriented Life">
<meta property="og:description" content="sync.Mutex &amp; sync.RWMutex Mutex and RWMutex are not associated with goroutines, but RWMutex is obviously more suitable for scenarios with more reads and less writes. For read performance only, RWM">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-04-18T00:00:00.000Z">
<meta property="article:modified_time" content="2025-06-10T09:49:34.929Z">
<meta property="article:author" content="CloudoLife">
<meta property="article:tag" content="Programming Language">
<meta property="article:tag" content="Golang (Go)">
<meta property="article:tag" content="Mutex">
<meta property="article:tag" content="RWMutex">
<meta property="article:tag" content="sync">
<meta property="article:tag" content="Lock">
<meta property="article:tag" content="Goroutine">
<meta property="article:tag" content="Race Condition">
<meta property="article:tag" content="Critical Section">
<meta property="article:tag" content="Synchronization">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://cloudolife.com/2020/04/18/Programming-Language/Golang-Go/Synchronization/Use-sync-Mutex-sync-RWMutex-to-lock-share-data-for-race-condition/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://cloudolife.com/2020/04/18/Programming-Language/Golang-Go/Synchronization/Use-sync-Mutex-sync-RWMutex-to-lock-share-data-for-race-condition/","path":"2020/04/18/Programming-Language/Golang-Go/Synchronization/Use-sync-Mutex-sync-RWMutex-to-lock-share-data-for-race-condition/","title":"[Golang (Go)] Use sync.Mutex, sync.RWMutex to lock share data for race condition"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>[Golang (Go)] Use sync.Mutex, sync.RWMutex to lock share data for race condition | Cloud-oriented Life</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8Y9QPJWXQN"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-8Y9QPJWXQN","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/js/third-party/analytics/google-analytics.js" defer></script>

  <script src="/js/third-party/analytics/baidu-analytics.js" defer></script>
  <script async src="https://hm.baidu.com/hm.js?995d7016a56cfd5c2ef6f2e6640a670e"></script>







  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script><script src="/js/bookmark.js" defer></script><script src="/js/pjax.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.3.1/pdfobject.min.js","integrity":"sha256-jI72I8ZLVflVOisZIOaLvRew3tyvzeu6aZXFm7P7dEo="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js" defer></script>






  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






<script data-ad-client="ca-pub-8693122033969144" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Cloud-oriented Life" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Cloud-oriented Life</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Cloud Native Technology Improves Lives</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">1646</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">331</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">584</span></a></li><li class="menu-item menu-item-ansible"><a href="/tags/Ansible/" rel="section"><i class="fa fa-book fa-fw"></i>Ansible</a></li><li class="menu-item menu-item-awesome-software"><a href="/tags/Awesome-Software/" rel="section"><i class="fa fa-book fa-fw"></i>Awesome Software</a></li><li class="menu-item menu-item-golang-(go)"><a href="/tags/Golang-Go/" rel="section"><i class="fa fa-book fa-fw"></i>Golang (Go)</a></li><li class="menu-item menu-item-helm"><a href="/tags/Helm/" rel="section"><i class="fa fa-book fa-fw"></i>Helm</a></li><li class="menu-item menu-item-java"><a href="/tags/Java/" rel="section"><i class="fa fa-book fa-fw"></i>Java</a></li><li class="menu-item menu-item-javascript"><a href="/tags/JavaScript/" rel="section"><i class="fa fa-book fa-fw"></i>JavaScript</a></li><li class="menu-item menu-item-knative"><a href="/tags/Knative/" rel="section"><i class="fa fa-book fa-fw"></i>Knative</a></li><li class="menu-item menu-item-kubernetes-(k8s)"><a href="/tags/Kubernetes-K8S/" rel="section"><i class="fa fa-book fa-fw"></i>Kubernetes (K8S)</a></li><li class="menu-item menu-item-macos"><a href="/tags/macOS/" rel="section"><i class="fa fa-book fa-fw"></i>macOS</a></li><li class="menu-item menu-item-python"><a href="/tags/Python/" rel="section"><i class="fa fa-book fa-fw"></i>Python</a></li><li class="menu-item menu-item-pulumi"><a href="/tags/Pulumi/" rel="section"><i class="fa fa-book fa-fw"></i>Pulumi</a></li><li class="menu-item menu-item-react"><a href="/tags/React/" rel="section"><i class="fa fa-book fa-fw"></i>React</a></li><li class="menu-item menu-item-ruby"><a href="/tags/Ruby/" rel="section"><i class="fa fa-book fa-fw"></i>Ruby</a></li><li class="menu-item menu-item-ruby-on-rails"><a href="/tags/Ruby-on-Rails-RoR/" rel="section"><i class="fa fa-book fa-fw"></i>Ruby On Rails</a></li><li class="menu-item menu-item-rust"><a href="/tags/Rust/" rel="section"><i class="fa fa-book fa-fw"></i>Rust</a></li><li class="menu-item menu-item-serverless"><a href="/tags/Serverless/" rel="section"><i class="fa fa-book fa-fw"></i>Serverless</a></li><li class="menu-item menu-item-service-mesh"><a href="/tags/Service-Mesh/" rel="section"><i class="fa fa-book fa-fw"></i>Service Mesh</a></li><li class="menu-item menu-item-svelte"><a href="/tags/Svelte/" rel="section"><i class="fa fa-book fa-fw"></i>Svelte</a></li><li class="menu-item menu-item-taro"><a href="/tags/Taro/" rel="section"><i class="fa fa-book fa-fw"></i>Taro</a></li><li class="menu-item menu-item-terraform"><a href="/tags/Terraform/" rel="section"><i class="fa fa-book fa-fw"></i>Terraform</a></li><li class="menu-item menu-item-typescript"><a href="/tags/TypeScript/" rel="section"><i class="fa fa-book fa-fw"></i>TypeScript</a></li><li class="menu-item menu-item-about"><a href="/about-us/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li><li class="menu-item menu-item-rss"><a href="/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>RSS</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="Searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">sync.Mutex &amp; sync.RWMutex</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#sync-Mutex"><span class="nav-number">1.1.</span> <span class="nav-text">sync.Mutex</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Examples"><span class="nav-number">1.1.1.</span> <span class="nav-text">Examples</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sync-RWMutex"><span class="nav-number">1.2.</span> <span class="nav-text">sync.RWMutex</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Examples-2"><span class="nav-number">1.2.1.</span> <span class="nav-text">Examples</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Built-in-types-suitable-for-sync-Mutex-or-sync-RWMutex"><span class="nav-number">1.3.</span> <span class="nav-text">Built-in types suitable for sync.Mutex or sync.RWMutex</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#FAQs"><span class="nav-number">1.4.</span> <span class="nav-text">FAQs</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Lock-and-Unlock-appear-unpaired"><span class="nav-number">1.4.1.</span> <span class="nav-text">Lock and Unlock appear unpaired</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Copy-used-Mutex"><span class="nav-number">1.4.2.</span> <span class="nav-text">Copy used Mutex</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Recursive-Locks"><span class="nav-number">1.4.3.</span> <span class="nav-text">Recursive Locks</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Deadlock"><span class="nav-number">1.4.4.</span> <span class="nav-text">Deadlock</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#References"><span class="nav-number">1.5.</span> <span class="nav-text">References</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">CloudoLife</p>
  <div class="site-description" itemprop="description">A Husband and Father, Knowledge Worker, Full-skilled Cloud Engineer</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">584</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">331</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">1646</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/CloudoLife" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;CloudoLife" rel="noopener me external nofollow noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/CloudoLife" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;CloudoLife" rel="noopener me external nofollow noreferrer" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          Links
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://cloudolife.cn/" title="https:&#x2F;&#x2F;cloudolife.cn" rel="noopener external nofollow noreferrer" target="_blank">CLoudoLife - Chinese (Simplified)</a>
            </li>
        </ul>
      </div>
    </div>
        <div class="pjax">
        </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://cloudolife.com/2020/04/18/Programming-Language/Golang-Go/Synchronization/Use-sync-Mutex-sync-RWMutex-to-lock-share-data-for-race-condition/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CloudoLife">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cloud-oriented Life">
      <meta itemprop="description" content="A Husband and Father, Knowledge Worker, Full-skilled Cloud Engineer">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="[Golang (Go)] Use sync.Mutex, sync.RWMutex to lock share data for race condition | Cloud-oriented Life">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          [Golang (Go)] Use sync.Mutex, sync.RWMutex to lock share data for race condition
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-04-18 00:00:00" itemprop="dateCreated datePublished" datetime="2020-04-18T00:00:00+00:00">2020-04-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-06-10 09:49:34" itemprop="dateModified" datetime="2025-06-10T09:49:34+00:00">2025-06-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Programming-Language/" itemprop="url" rel="index"><span itemprop="name">Programming Language</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Programming-Language/Golang-Go/" itemprop="url" rel="index"><span itemprop="name">Golang (Go)</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Programming-Language/Golang-Go/Synchronization/" itemprop="url" rel="index"><span itemprop="name">Synchronization</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>11k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>10 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1>sync.Mutex &amp; sync.RWMutex</h1>
<p>Mutex and RWMutex are not associated with goroutines, but RWMutex is obviously more suitable for scenarios with more reads and less writes. For read performance only, RWMutex is higher than Mutex, because multiple reads of rwmutex can coexist.</p>
<span id="more"></span>
<h2 id="sync-Mutex">sync.Mutex</h2>
<p>A Mutex is a mutual exclusion lock. The zero value for a Mutex is an unlocked mutex.</p>
<p>A Mutex must not be copied after first use.</p>
<p>A <code>Mutex</code> is a method used as a locking mechanism to ensure that only one Goroutine is accessing the critical section of code at any point of time. This is done to prevent race conditions from happening. <code>sync</code> package contains the <code>Mutex</code>. Two methods defined on <code>Mutex</code>:</p>
<ul>
<li>
<p>func (m *Mutex) Lock()</p>
<p>Lock locks m. If the lock is already in use, the calling goroutine blocks until the mutex is available.</p>
</li>
<li>
<p>func (m *Mutex) Unlock()</p>
<p>Unlock unlocks m. It is a run-time error if m is not locked on entry to Unlock.</p>
</li>
</ul>
<p>A locked Mutex is not associated with a particular goroutine. It is allowed for one goroutine to lock a Mutex and then arrange for another goroutine to unlock it.</p>
<h3 id="Examples">Examples</h3>
<p>Example 1.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mutex.Lock() </span><br><span class="line"></span><br><span class="line">x = x + <span class="number">1</span> <span class="comment">// this statement be executed by only one Goroutine at any point of time  </span></span><br><span class="line"></span><br><span class="line">mutex.Unlock()</span><br></pre></td></tr></table></figure>
<p>Example 2.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.go</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// SafeCounter is safe to use concurrently.</span></span><br><span class="line"><span class="keyword">type</span> SafeCounter <span class="keyword">struct</span> &#123;</span><br><span class="line">	mu sync.Mutex</span><br><span class="line">	v  <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Inc increments the counter for the given key.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *SafeCounter)</span></span> Inc(key <span class="type">string</span>) &#123;</span><br><span class="line">	c.mu.Lock()</span><br><span class="line">	<span class="comment">// Lock so only one goroutine at a time can access the map c.v.</span></span><br><span class="line">	c.v[key]++</span><br><span class="line">	c.mu.Unlock()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Value returns the current value of the counter for the given key.</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *SafeCounter)</span></span> Value(key <span class="type">string</span>) <span class="type">int</span> &#123;</span><br><span class="line">	c.mu.Lock()</span><br><span class="line">	<span class="comment">// Lock so only one goroutine at a time can access the map c.v.</span></span><br><span class="line">	<span class="keyword">defer</span> c.mu.Unlock()</span><br><span class="line">	<span class="keyword">return</span> c.v[key]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	c := SafeCounter&#123;v: <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int</span>)&#125;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++ &#123;</span><br><span class="line">		<span class="keyword">go</span> c.Inc(<span class="string">&quot;somekey&quot;</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	time.Sleep(time.Second)</span><br><span class="line">	fmt.Println(c.Value(<span class="string">&quot;somekey&quot;</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Run it will output:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">go run main.go</span></span><br><span class="line">1000</span><br></pre></td></tr></table></figure>
<h2 id="sync-RWMutex">sync.RWMutex</h2>
<p>Using RWMutex, a reader/writer mutual exclusion lock which allows any number of readers to hold the lock or one writer. This tends to be more efficient than using a full mutex in situations where you have a high ratio of reads to writes.</p>
<p>A RWMutex must not be copied after first use.</p>
<p>If a goroutine holds a RWMutex for reading and another goroutine might call Lock, no goroutine should expect to be able to acquire a read lock until the initial read lock is released. In particular, this prohibits recursive read locking. This is to ensure that the lock eventually becomes available; a blocked Lock call excludes new readers from acquiring the lock.</p>
<ul>
<li>
<p><code>RWMutex</code> is based on <code>Mutex</code>. On the basis of Mutex, read and write semaphores are added, and the number of read locks similar to reference counting is used.</p>
</li>
<li>
<p>Read locks are compatible with read locks, read locks and write locks are mutually exclusive, and write locks and write locks are mutually exclusive. Only after the lock is released can you continue to apply for mutually exclusive locks:</p>
</li>
<li>
<p>You can apply for multiple read locks at the same time</p>
</li>
<li>
<p>Applying for a write lock when there is a read lock will block, and applying for a read lock when there is a write lock will block</p>
</li>
<li>
<p>As long as there is a write lock, subsequent applications for read locks and write locks will block</p>
</li>
</ul>
<p>There are methods defined on <code>RWMutex</code>:</p>
<ul>
<li>
<p>func (rw *RWMutex) Lock()</p>
<p>Lock locks rw for writing. If the lock is already locked for reading or writing, Lock blocks until the lock is available.</p>
</li>
<li>
<p>func (rw *RWMutex) RLock()</p>
<p>RLock locks rw for reading.</p>
<p>It should not be used for recursive read locking; a blocked Lock call excludes new readers from acquiring the lock. See the documentation on the RWMutex type.</p>
</li>
<li>
<p>func (rw *RWMutex) RUnlock()</p>
<p>RUnlock undoes a single RLock call; it does not affect other simultaneous readers. It is a run-time error if rw is not locked for reading on entry to RUnlock.</p>
</li>
<li>
<p>func (rw *RWMutex) Unlock()</p>
<p>Unlock unlocks rw for writing. It is a run-time error if rw is not locked for writing on entry to Unlock.</p>
</li>
</ul>
<p>As with Mutexes, a locked RWMutex is not associated with a particular goroutine. One goroutine may RLock (Lock) a RWMutex and then arrange for another goroutine to RUnlock (Unlock) it.</p>
<h3 id="Examples-2">Examples</h3>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.go</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;sync&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> RWMap <span class="keyword">struct</span> &#123;</span><br><span class="line">    sync.RWMutex</span><br><span class="line">    m <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get is a wrapper for getting the value from the underlying map</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r RWMap)</span></span> Get(key <span class="type">string</span>) <span class="type">int</span> &#123;</span><br><span class="line">    r.RLock()</span><br><span class="line">    <span class="keyword">defer</span> r.RUnlock()</span><br><span class="line">    <span class="keyword">return</span> r.m[key]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set is a wrapper for setting the value of a key in the underlying map</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r RWMap)</span></span> Set(key <span class="type">string</span>, val <span class="type">int</span>) &#123;</span><br><span class="line">    r.Lock()</span><br><span class="line">    <span class="keyword">defer</span> r.Unlock()</span><br><span class="line">    r.m[key] = val</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Inc increases the value in the RWMap for a key.</span></span><br><span class="line"><span class="comment">//   This is more pleasant than r.Set(key, r.Get(key)++)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r RWMap)</span></span> Inc(key <span class="type">string</span>) &#123;</span><br><span class="line">    r.Lock()</span><br><span class="line">    <span class="keyword">defer</span> r.Unlock()</span><br><span class="line">    r.m[key]++</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Init</span></span><br><span class="line">    counter := RWMap&#123;m: <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">int</span>)&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get a Read Lock</span></span><br><span class="line">    counter.RLock()</span><br><span class="line">    _ = counter.m[<span class="string">&quot;Key&quot;</span>]</span><br><span class="line">    counter.RUnlock()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// the above could be replaced with</span></span><br><span class="line">    _ = counter.Get(<span class="string">&quot;Key&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get a write Lock</span></span><br><span class="line">    counter.Lock()</span><br><span class="line">    counter.m[<span class="string">&quot;some_key&quot;</span>]++</span><br><span class="line">    counter.Unlock()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// above would need to be written as </span></span><br><span class="line">    counter.Inc(<span class="string">&quot;some_key&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Built-in-types-suitable-for-sync-Mutex-or-sync-RWMutex">Built-in types suitable for sync.Mutex or sync.RWMutex</h2>
<p>To use sync.Mutex and Lock() and Unlock() to protect shared variables of built-in types, because they do not contain Mutex properties. Really reasonable shared variables are those struct types that contain Mutex properties:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> mytype <span class="keyword">struct</span> &#123;</span><br><span class="line">    m sync.Mutex <span class="comment">// Or sync.RWMutex</span></span><br><span class="line">    <span class="keyword">var</span> <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">x := <span class="built_in">new</span>(mytype)</span><br></pre></td></tr></table></figure>
<p>At this time, as long as you want to protect the var variable, <code>x.m.Lock()</code> first, and then <code>x.m.Unlock()</code> after the var operation is completed. This will ensure that the var field variable in <code>x</code> must be protected.</p>
<h2 id="FAQs">FAQs</h2>
<h3 id="Lock-and-Unlock-appear-unpaired">Lock and Unlock appear unpaired</h3>
<p>Lock/Unlock operations do not appear in pairs, and there are two situations:</p>
<ul>
<li>
<p>Only with Lock</p>
<p>If there is a goroutine that only performs the Lock operation and not the Unlock operation, then other goroutines will always be blocked (cannot get the lock), and the entire system will eventually crash as more and more blocked goroutines.</p>
</li>
<li>
<p>Only the case of Unlock</p>
<p>If a goroutine only performs the Unlock operation, there will be two situations:</p>
<ul>
<li>
<p>If other goroutine hold the lock, the lock will be released.</p>
</li>
<li>
<p>If the lock is in an unoccupied state, it will panic.</p>
</li>
</ul>
</li>
</ul>
<p>As mentioned earlier, Mutex does not storage the information of the goroutine, so no matter which goroutine executes the Unlock operation, it will have an unlocking effect.</p>
<h3 id="Copy-used-Mutex">Copy used Mutex</h3>
<p>The synchronization primitives in the <code>sync</code> package cannot be copied. <code>Mutex</code>, as the most commonly used synchronization primitive, of course cannot be copied.</p>
<p>The reason is that <code>Mutex</code> is a stateful object. If you copy a <code>Mutex</code>, the corresponding state will also be copied. Such a new <code>Mutex</code> may be in a state of holding locks, waking up, or starving, or even waiting for the number of blocked waits to be far greater than zero.</p>
<p>However, Go has a deadlock check mechanism. If this happens, run it directly, and an error will be reported. In addition, you can also use the go vet tool to actively check for deadlocks.</p>
<p>Example:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.go</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;sync&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">copyF</span><span class="params">(m sync.Mutex)</span></span> &#123;</span><br><span class="line">    m.Lock()</span><br><span class="line">    <span class="keyword">defer</span> m.Unlock()</span><br><span class="line">    <span class="comment">// TODO</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> m sync.Mutex</span><br><span class="line">    m.Lock()</span><br><span class="line">    <span class="keyword">defer</span> m.Unlock()</span><br><span class="line">    <span class="comment">// TODO</span></span><br><span class="line">    copyF(m) <span class="comment">// m is passed in by copying</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Go run directly will report an error, <code>go vet main.go</code>, the result is as follows:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">main.go:9:14: copyF passes lock by value: sync.Mutex</span><br><span class="line">main.go:24:8: call of copyF copies lock value: sync.Mutex</span><br></pre></td></tr></table></figure>
<p>If you simply copy <code>Mutex</code> without using it, <code>go run</code> can run normally, and only <code>go vet</code> can detect it.</p>
<h3 id="Recursive-Locks">Recursive Locks</h3>
<p>After one goroutine preempts the lock, other goroutines cannot preempt the lock, but what if the goroutine locks itself again? Reentrant lock means that the current goroutine can still seize the lock again. Reentrant locks are generally called “recursive locks”</p>
<p><code>Mutex</code> is not a reentrant lock! As mentioned earlier, Mutex does not storage the information of the goroutine holding the lock, so it cannot distinguish whether it is reentrant or not.</p>
<p>How to find a way to make Mutex bring the goroutine flag information?</p>
<ul>
<li>
<p>Get the goroutine id, and use this id to uniquely identify the goroutine. Some open source packages can do this.</p>
</li>
<li>
<p>The goroutine provides a token by itself, and uses this token to uniquely identify the goroutine.</p>
</li>
</ul>
<p>The ideas of these two ways are to obtain the unique identification of the goroutine, so that when the reentry lock is locked, it can be judged whether the same goroutine is locked.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// RecursiveMutex wraps a Mutex to achieve reentrancy</span></span><br><span class="line"><span class="keyword">type</span> RecursiveMutex <span class="keyword">struct</span> &#123;</span><br><span class="line">    sync.Mutex</span><br><span class="line">    owner <span class="type">int64</span> <span class="comment">// The goroutine id currently holding the lock</span></span><br><span class="line">    recursion <span class="type">int32</span> <span class="comment">// The number of times this goroutine reenters</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *RecursiveMutex)</span></span> Lock() &#123;</span><br><span class="line">    gid := goid.Get()</span><br><span class="line">    <span class="comment">// If the goroutine currently holding the lock is the goroutine called this time, it means reentrant</span></span><br><span class="line">    <span class="keyword">if</span> atomic.LoadInt64(&amp;m.owner) == gid &#123;</span><br><span class="line">        m.recursion++</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    m.Mutex.Lock()</span><br><span class="line">    <span class="comment">// The first call of the goroutine that acquired the lock, record its goroutine id, and add 1 to the number of calls</span></span><br><span class="line">    atomic.StoreInt64(&amp;m.owner, gid)</span><br><span class="line">    m.recursion = <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *RecursiveMutex)</span></span> Unlock() &#123;</span><br><span class="line">    gid := goid.Get()</span><br><span class="line">    <span class="comment">// The goroutine that does not hold the lock tries to release the lock and uses it incorrectly</span></span><br><span class="line">    <span class="keyword">if</span> atomic.LoadInt64(&amp;m.owner) != gid &#123;</span><br><span class="line">        <span class="built_in">panic</span>(fmt.Sprintf(<span class="string">&quot;wrong the owner(%d): %d!&quot;</span>, m.owner, gid))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// The number of calls minus 1</span></span><br><span class="line">    m.recursion--</span><br><span class="line">    <span class="keyword">if</span> m.recursion != <span class="number">0</span> &#123;<span class="comment">// If this goroutine has not been completely released, return directly</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// The last time this goroutine is called, the lock needs to be released</span></span><br><span class="line">    atomic.StoreInt64(&amp;m.owner, <span class="number">-1</span>)</span><br><span class="line">    m.Mutex.Unlock()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In fact, this piece of code only needs to look at the definition of RecursiveMutex in lines 2-6 to guess the general logic: mark the holder of the lock, and use a counter to record the number of reentries. When reentering, the actual operation is counter +1, when unlocking, the counter is -1, until the last time, the lock is really released.</p>
<h3 id="Deadlock">Deadlock</h3>
<p>A deadlock is a situation where two or more goroutines are waiting for each other due to contention for resources during the execution process. If there is no external intervention, they will not be able to move forward. This situation is called a deadlock.</p>
<p>Necessary conditions for deadlock:</p>
<ul>
<li>
<p>Mutually exclusive: the resources being scrambled are exclusive and not shared</p>
</li>
<li>
<p>Hold and wait: A goroutine holds a resource and is still requesting resources held by other goroutines.</p>
</li>
<li>
<p>Inalienable: the resource can only wait for the goroutine holding it to be released</p>
</li>
<li>
<p>Loop waiting: n goroutines P1-Pn, P1 waits for P2, …, Pn-1 waits for Pn, and finally Pn waits for P1</p>
</li>
</ul>
<p>If you want to avoid deadlock, just destroy one or more of the above 4 conditions.</p>
<p>In fact, the Mutex example used by Copy meets the above four conditions (imagine the main function and copyF as two goroutines).</p>
<p>Especially for the last condition, the main function has to wait for copyF to complete before proceeding to the next step; and copyF is blocked because it cannot get the lock (waiting for main to release the lock), and eventually a deadlock is formed.</p>
<h2 id="References">References</h2>
<p>[1] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://golang.org/pkg/sync/#Mutex">Mutex | sync - The Go Programming Language - https://golang.org/pkg/sync/#Mutex</a></p>
<p>[2] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://tour.golang.org/concurrency/9">sync.Mutex | A Tour of Go - https://tour.golang.org/concurrency/9</a></p>
<p>[3] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://golangbot.com/mutex/">Go (Golang) Mutex Tutorial with Examples - golangbot.com - https://golangbot.com/mutex/</a></p>
<p>[4] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://betterprogramming.pub/using-synchronization-primitives-in-go-mutex-waitgroup-once-2e50359cb0a7">Using Synchronization Primitives in Go | by Abhishek Gupta | Better Programming - https://betterprogramming.pub/using-synchronization-primitives-in-go-mutex-waitgroup-once-2e50359cb0a7</a></p>
<p>[5] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://golang.org/pkg/sync/#RWMutex">RWMutex | sync - The Go Programming Language - https://golang.org/pkg/sync/#RWMutex</a></p>
<p>[6] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://dev.to/wagslane/golang-mutexes-what-is-rwmutex-for-57a0">Golang Mutexes – What Is RWMutex For? - DEV Community - https://dev.to/wagslane/golang-mutexes-what-is-rwmutex-for-57a0</a></p>
<p>[7] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://riptutorial.com/go/example/3423/concurrent-access-of-maps">Go - Concurrent Access of Maps | go Tutorial - https://riptutorial.com/go/example/3423/concurrent-access-of-maps</a></p>
<p>[8] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://medium.com/@bytecraze.com/recursive-locking-in-go-9c1c2a106a38">Recursive Locking in Go. Go’s built-in Mutex doesn’t support… | by bytecraze | Medium - https://medium.com/@bytecraze.com/recursive-locking-in-go-9c1c2a106a38</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/bitcoin.png" alt="CloudoLife Bitcoin">
        <span>Bitcoin</span>
      </div>

  </div>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/CloudoLife" rel="external nofollow noreferrer">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://t.me/CloudoLife" rel="external nofollow noreferrer">
            <span class="icon">
              <i class="fab fa-telegram"></i>
            </span>

            <span class="label">Telegram</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/Programming-Language/" rel="tag"># Programming Language</a>
              <a href="/tags/Golang-Go/" rel="tag"># Golang (Go)</a>
              <a href="/tags/Mutex/" rel="tag"># Mutex</a>
              <a href="/tags/RWMutex/" rel="tag"># RWMutex</a>
              <a href="/tags/sync/" rel="tag"># sync</a>
              <a href="/tags/Lock/" rel="tag"># Lock</a>
              <a href="/tags/Goroutine/" rel="tag"># Goroutine</a>
              <a href="/tags/Race-Condition/" rel="tag"># Race Condition</a>
              <a href="/tags/Critical-Section/" rel="tag"># Critical Section</a>
              <a href="/tags/Synchronization/" rel="tag"># Synchronization</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/04/14/Programming-Language/Golang-Go/Module/Use-go-mod-to-manage-modules-dependency-and-version/" rel="prev" title="Use go mod to manage modules dependency and version">
                  <i class="fa fa-angle-left"></i> Use go mod to manage modules dependency and version
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/04/18/Programming-Language/Golang-Go/Logging/Use-log-package-to-output-logs/" rel="next" title="[Golang (Go)] Use log package to output log">
                  [Golang (Go)] Use log package to output log <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">CloudoLife</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">2.6m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">39:58</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener external nofollow noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener external nofollow noreferrer" target="_blank">NexT.Pisces</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"CloudoLife","repo":"col-hexo-CloudoLife.github.io","client_id":"4ca3ae8fb3a49237db9a","client_secret":"98d6652508799ef4350ab05aabe855e58f549112","admin_user":"benjamincloudolife","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":null,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"20f6a024e71f7e5fe08fe1973ea724d9"}</script>
<script src="/js/third-party/comments/gitalk.js" defer></script>

</body>
</html>
