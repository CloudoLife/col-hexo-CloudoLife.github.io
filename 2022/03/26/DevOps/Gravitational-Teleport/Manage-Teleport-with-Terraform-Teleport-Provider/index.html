<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="sJgro_9-KyRL3EkTM5KW84pQPrg2Fv1KdkibDRBIulE">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"cloudolife.com","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.23.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="Terraform Teleport Provider Terraform is an open-source infrastructure as code software tool that provides a consistent CLI workflow to manage hundreds of cloud services. Terraform codifies cloud APIs">
<meta property="og:type" content="article">
<meta property="og:title" content="[Infrastructure as Code (IaC)] Manage Teleport with Terraform Teleport Provider">
<meta property="og:url" content="https://cloudolife.com/2022/03/26/DevOps/Gravitational-Teleport/Manage-Teleport-with-Terraform-Teleport-Provider/index.html">
<meta property="og:site_name" content="Cloud-oriented Life">
<meta property="og:description" content="Terraform Teleport Provider Terraform is an open-source infrastructure as code software tool that provides a consistent CLI workflow to manage hundreds of cloud services. Terraform codifies cloud APIs">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-03-26T00:00:00.000Z">
<meta property="article:modified_time" content="2025-06-10T09:49:34.913Z">
<meta property="article:author" content="CloudoLife">
<meta property="article:tag" content="Infrastructure as Code (IaC)">
<meta property="article:tag" content="Terraform">
<meta property="article:tag" content="Best Practices">
<meta property="article:tag" content="Security">
<meta property="article:tag" content="DevOps">
<meta property="article:tag" content="Teleport">
<meta property="article:tag" content="Gravitational">
<meta property="article:tag" content="Gravitational Teleport">
<meta property="article:tag" content="IaC">
<meta property="article:tag" content="Infrastructure as Code">
<meta property="article:tag" content="tsh">
<meta property="article:tag" content="Bastion">
<meta property="article:tag" content="CA">
<meta property="article:tag" content="Certificate Authority">
<meta property="article:tag" content="Certificate Authority (CA)">
<meta property="article:tag" content="AP">
<meta property="article:tag" content="Access Plane">
<meta property="article:tag" content="Access Plane (AP)">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://cloudolife.com/2022/03/26/DevOps/Gravitational-Teleport/Manage-Teleport-with-Terraform-Teleport-Provider/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://cloudolife.com/2022/03/26/DevOps/Gravitational-Teleport/Manage-Teleport-with-Terraform-Teleport-Provider/","path":"2022/03/26/DevOps/Gravitational-Teleport/Manage-Teleport-with-Terraform-Teleport-Provider/","title":"[Infrastructure as Code (IaC)] Manage Teleport with Terraform Teleport Provider"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>[Infrastructure as Code (IaC)] Manage Teleport with Terraform Teleport Provider | Cloud-oriented Life</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8Y9QPJWXQN"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-8Y9QPJWXQN","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/js/third-party/analytics/google-analytics.js" defer></script>

  <script src="/js/third-party/analytics/baidu-analytics.js" defer></script>
  <script async src="https://hm.baidu.com/hm.js?995d7016a56cfd5c2ef6f2e6640a670e"></script>







  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script><script src="/js/bookmark.js" defer></script><script src="/js/pjax.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.3.1/pdfobject.min.js","integrity":"sha256-jI72I8ZLVflVOisZIOaLvRew3tyvzeu6aZXFm7P7dEo="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js" defer></script>






  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






<script data-ad-client="ca-pub-8693122033969144" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Cloud-oriented Life" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Cloud-oriented Life</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Cloud Native Technology Improves Lives</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">1646</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">331</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">584</span></a></li><li class="menu-item menu-item-ansible"><a href="/tags/Ansible/" rel="section"><i class="fa fa-book fa-fw"></i>Ansible</a></li><li class="menu-item menu-item-awesome-software"><a href="/tags/Awesome-Software/" rel="section"><i class="fa fa-book fa-fw"></i>Awesome Software</a></li><li class="menu-item menu-item-golang-(go)"><a href="/tags/Golang-Go/" rel="section"><i class="fa fa-book fa-fw"></i>Golang (Go)</a></li><li class="menu-item menu-item-helm"><a href="/tags/Helm/" rel="section"><i class="fa fa-book fa-fw"></i>Helm</a></li><li class="menu-item menu-item-java"><a href="/tags/Java/" rel="section"><i class="fa fa-book fa-fw"></i>Java</a></li><li class="menu-item menu-item-javascript"><a href="/tags/JavaScript/" rel="section"><i class="fa fa-book fa-fw"></i>JavaScript</a></li><li class="menu-item menu-item-knative"><a href="/tags/Knative/" rel="section"><i class="fa fa-book fa-fw"></i>Knative</a></li><li class="menu-item menu-item-kubernetes-(k8s)"><a href="/tags/Kubernetes-K8S/" rel="section"><i class="fa fa-book fa-fw"></i>Kubernetes (K8S)</a></li><li class="menu-item menu-item-macos"><a href="/tags/macOS/" rel="section"><i class="fa fa-book fa-fw"></i>macOS</a></li><li class="menu-item menu-item-python"><a href="/tags/Python/" rel="section"><i class="fa fa-book fa-fw"></i>Python</a></li><li class="menu-item menu-item-pulumi"><a href="/tags/Pulumi/" rel="section"><i class="fa fa-book fa-fw"></i>Pulumi</a></li><li class="menu-item menu-item-react"><a href="/tags/React/" rel="section"><i class="fa fa-book fa-fw"></i>React</a></li><li class="menu-item menu-item-ruby"><a href="/tags/Ruby/" rel="section"><i class="fa fa-book fa-fw"></i>Ruby</a></li><li class="menu-item menu-item-ruby-on-rails"><a href="/tags/Ruby-on-Rails-RoR/" rel="section"><i class="fa fa-book fa-fw"></i>Ruby On Rails</a></li><li class="menu-item menu-item-rust"><a href="/tags/Rust/" rel="section"><i class="fa fa-book fa-fw"></i>Rust</a></li><li class="menu-item menu-item-serverless"><a href="/tags/Serverless/" rel="section"><i class="fa fa-book fa-fw"></i>Serverless</a></li><li class="menu-item menu-item-service-mesh"><a href="/tags/Service-Mesh/" rel="section"><i class="fa fa-book fa-fw"></i>Service Mesh</a></li><li class="menu-item menu-item-svelte"><a href="/tags/Svelte/" rel="section"><i class="fa fa-book fa-fw"></i>Svelte</a></li><li class="menu-item menu-item-taro"><a href="/tags/Taro/" rel="section"><i class="fa fa-book fa-fw"></i>Taro</a></li><li class="menu-item menu-item-terraform"><a href="/tags/Terraform/" rel="section"><i class="fa fa-book fa-fw"></i>Terraform</a></li><li class="menu-item menu-item-typescript"><a href="/tags/TypeScript/" rel="section"><i class="fa fa-book fa-fw"></i>TypeScript</a></li><li class="menu-item menu-item-about"><a href="/about-us/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li><li class="menu-item menu-item-rss"><a href="/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>RSS</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="Searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">Terraform Teleport Provider</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Prerequsites"><span class="nav-number">1.1.</span> <span class="nav-text">Prerequsites</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Usages"><span class="nav-number">1.2.</span> <span class="nav-text">Usages</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Step-1-4-Install-the-Terraform-provider"><span class="nav-number">1.2.1.</span> <span class="nav-text">Step 1&#x2F;4. Install the Terraform provider</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step-2-4-Create-a-Terraform-user"><span class="nav-number">1.2.2.</span> <span class="nav-text">Step 2&#x2F;4. Create a Terraform user</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Enable-impersonation"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">Enable impersonation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Create-the-Terraform-user"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">Create the Terraform user</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Self-Hosted"><span class="nav-number">1.2.2.2.1.</span> <span class="nav-text">Self-Hosted</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Teleport-Cloud"><span class="nav-number">1.2.2.2.2.</span> <span class="nav-text">Teleport Cloud</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step-3-4-Create-a-Terraform-configuration"><span class="nav-number">1.2.3.</span> <span class="nav-text">Step 3&#x2F;4. Create a Terraform configuration</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Self-Hosted-2"><span class="nav-number">1.2.3.1.</span> <span class="nav-text">Self-Hosted</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Teleport-Cloud-2"><span class="nav-number">1.2.3.2.</span> <span class="nav-text">Teleport Cloud</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step-4-4-Apply-the-configuration"><span class="nav-number">1.2.4.</span> <span class="nav-text">Step 4&#x2F;4. Apply the configuration</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Self-Hosted-3"><span class="nav-number">1.2.4.1.</span> <span class="nav-text">Self-Hosted</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Teleport-Cloud-3"><span class="nav-number">1.2.4.2.</span> <span class="nav-text">Teleport Cloud</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#References"><span class="nav-number">1.3.</span> <span class="nav-text">References</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">CloudoLife</p>
  <div class="site-description" itemprop="description">A Husband and Father, Knowledge Worker, Full-skilled Cloud Engineer</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">584</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">331</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">1646</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/CloudoLife" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;CloudoLife" rel="noopener me external nofollow noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/CloudoLife" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;CloudoLife" rel="noopener me external nofollow noreferrer" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          Links
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://cloudolife.cn/" title="https:&#x2F;&#x2F;cloudolife.cn" rel="noopener external nofollow noreferrer" target="_blank">CLoudoLife - Chinese (Simplified)</a>
            </li>
        </ul>
      </div>
    </div>
        <div class="pjax">
        </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://cloudolife.com/2022/03/26/DevOps/Gravitational-Teleport/Manage-Teleport-with-Terraform-Teleport-Provider/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CloudoLife">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cloud-oriented Life">
      <meta itemprop="description" content="A Husband and Father, Knowledge Worker, Full-skilled Cloud Engineer">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="[Infrastructure as Code (IaC)] Manage Teleport with Terraform Teleport Provider | Cloud-oriented Life">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          [Infrastructure as Code (IaC)] Manage Teleport with Terraform Teleport Provider
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-03-26 00:00:00" itemprop="dateCreated datePublished" datetime="2022-03-26T00:00:00+00:00">2022-03-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-06-10 09:49:34" itemprop="dateModified" datetime="2025-06-10T09:49:34+00:00">2025-06-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DevOps/" itemprop="url" rel="index"><span itemprop="name">DevOps</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DevOps/Gravitational-Teleport/" itemprop="url" rel="index"><span itemprop="name">Gravitational Teleport</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/DevOps/Gravitational-Teleport/Terraform/" itemprop="url" rel="index"><span itemprop="name">Terraform</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>8.2k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>7 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1>Terraform Teleport Provider</h1>
<p>Terraform is an open-source infrastructure as code software tool that provides a consistent CLI workflow to manage hundreds of cloud services. Terraform codifies cloud APIs into declarative configuration files.</p>
<p>Teleport is a Certificate Authority and an Access Plane for your infrastructure. With Teleport you can:</p>
<p>Terraform relies on plugins called “providers” to interact with cloud providers, SaaS providers, and other APIs.</p>
<p>Terraform configurations must declare which providers they require so that Terraform can install and use them. Additionally, some providers require configuration (like endpoint URLs or cloud regions) before they can be used.</p>
<p>This article describe how to use Terraform to manage Teleport resources.</p>
<span id="more"></span>
<h2 id="Prerequsites">Prerequsites</h2>
<ul>
<li>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.terraform.io/">Terraform by HashiCorp</a></p>
<p>Use Infrastructure as Code to provision and manage any cloud, infrastructure, or service</p>
</li>
<li>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://goteleport.com/">Teleport: Easiest, most secure way to access infrastructure | Teleport - https://goteleport.com/</a></p>
<p>Teleport is a Certificate Authority and an Access Plane for your infrastructure. With Teleport you can:</p>
<p>See <a target="_blank" rel="noopener external nofollow noreferrer" href="https://goteleport.com/docs/installation/">Installing Teleport | Teleport Docs - https://goteleport.com/docs/installation/</a> to learn more.</p>
</li>
</ul>
<h2 id="Usages">Usages</h2>
<h3 id="Step-1-4-Install-the-Terraform-provider">Step 1/4. Install the Terraform provider</h3>
<p>Create a folder <code>teleport-terraform</code> to hold some temporary files:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mkdir</span> -p teleport-terraform</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> teleport-terraform</span></span><br></pre></td></tr></table></figure>
<p>Then, install the Terraform provider.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">MacOS</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">mkdir</span> -p <span class="variable">$&#123;HOME?&#125;</span>/.terraform.d/plugins/gravitational.com/teleport/teleport/9.0.3/darwin_amd64</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">curl -L -O https://get.gravitational.com/terraform-provider-teleport-v9.0.3-darwin-amd64-bin.tar.gz</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tar -zxvf terraform-provider-teleport-v9.0.3-darwin-amd64-bin.tar.gz -C <span class="variable">$&#123;HOME?&#125;</span>/.terraform.d/plugins/gravitational.com/teleport/teleport/9.0.3/darwin_amd64</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="comment"># Linux</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">$ <span class="built_in">mkdir</span> -p <span class="variable">$&#123;HOME?&#125;</span>/.terraform.d/plugins/gravitational.com/teleport/teleport/9.0.3/linux_amd64</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">$ curl -L -O https://get.gravitational.com/terraform-provider-teleport-v9.0.3-linux-amd64-bin.tar.gz</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">$ tar -zxvf terraform-provider-teleport-v9.0.3-linux-amd64-bin.tar.gz -C <span class="variable">$&#123;HOME?&#125;</span>/.terraform.d/plugins/gravitational.com/teleport/teleport/9.0.3/linux_amd64</span></span><br></pre></td></tr></table></figure>
<h3 id="Step-2-4-Create-a-Terraform-user">Step 2/4. Create a Terraform user</h3>
<h4 id="Enable-impersonation">Enable impersonation</h4>
<p>In order for Terraform to manage resources in your Teleport cluster, it needs a signed identity file from the cluster’s certificate authority. The Terraform user cannot request this itself, and requires another user to impersonate this account in order to request a certificate.</p>
<p>Create a role that enables your user to impersonate the Terraform user. First, paste the following YAML document into a file called <code>terraform-impersonator.yaml</code>:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># terraform-impersonator.yaml</span></span><br><span class="line"></span><br><span class="line"><span class="attr">kind:</span> <span class="string">role</span></span><br><span class="line"><span class="attr">version:</span> <span class="string">v5</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">terraform-impersonator</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="comment"># SSH options used for user sessions</span></span><br><span class="line">  <span class="attr">options:</span></span><br><span class="line">    <span class="comment"># max_session_ttl defines the TTL (time to live) of SSH certificates</span></span><br><span class="line">    <span class="comment"># issued to the users with this role.</span></span><br><span class="line">    <span class="attr">max_session_ttl:</span> <span class="string">10h</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># The allow section declares a list of resource/verb combinations that are</span></span><br><span class="line">  <span class="comment"># allowed for the users of this role. By default, nothing is allowed.</span></span><br><span class="line">  <span class="attr">allow:</span></span><br><span class="line">    <span class="attr">impersonate:</span></span><br><span class="line">      <span class="attr">users:</span> [<span class="string">&#x27;terraform&#x27;</span>]</span><br><span class="line">      <span class="attr">roles:</span> [<span class="string">&#x27;terraform&#x27;</span>]</span><br><span class="line"></span><br><span class="line">  <span class="comment"># The deny section uses the identical format as the &#x27;allow&#x27; section.</span></span><br><span class="line">  <span class="comment"># Deny rules always override allow rules.</span></span><br><span class="line">  <span class="attr">deny:</span></span><br><span class="line">    <span class="attr">node_labels:</span></span><br><span class="line">      <span class="attr">&#x27;*&#x27;:</span> <span class="string">&#x27;*&#x27;</span></span><br></pre></td></tr></table></figure>
<p>Next, create the role:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tctl create terraform-impersonator.yaml</span></span><br></pre></td></tr></table></figure>
<p>Assign this role to the current user. Log in to your Teleport cluster to assume the new role.</p>
<h4 id="Create-the-Terraform-user">Create the Terraform user</h4>
<p>Put the following content into <code>terraform.yaml</code>:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># terraform.yaml</span></span><br><span class="line"></span><br><span class="line"><span class="attr">kind:</span> <span class="string">role</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">terraform</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">allow:</span></span><br><span class="line">    <span class="attr">rules:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">resources:</span> [<span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;role&#x27;</span>, <span class="string">&#x27;token&#x27;</span>, <span class="string">&#x27;trusted_cluster&#x27;</span>, <span class="string">&#x27;github&#x27;</span>, <span class="string">&#x27;oidc&#x27;</span>, <span class="string">&#x27;saml&#x27;</span>]</span><br><span class="line">        <span class="attr">verbs:</span> [<span class="string">&#x27;list&#x27;</span>,<span class="string">&#x27;create&#x27;</span>,<span class="string">&#x27;read&#x27;</span>,<span class="string">&#x27;update&#x27;</span>,<span class="string">&#x27;delete&#x27;</span>]</span><br><span class="line"><span class="attr">version:</span> <span class="string">v5</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">user</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">terraform</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">roles:</span> [<span class="string">&#x27;terraform&#x27;</span>]</span><br><span class="line"><span class="attr">version:</span> <span class="string">v2</span></span><br></pre></td></tr></table></figure>
<p>Create the terraform user and role.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tctl create terraform.yaml</span></span><br></pre></td></tr></table></figure>
<p>Next, request a signed certificate for the Terraform user:</p>
<h5 id="Self-Hosted">Self-Hosted</h5>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Self-Hosted</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tctl auth sign --format=tls --user=terraform --out=auth</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Teleport Cloud</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">$ tctl auth sign --user=terraform --out=terraform-identity</span></span><br></pre></td></tr></table></figure>
<p>This command should result in three PEM-encoded files: <code>auth.crt</code>, <code>auth.key</code>, and <code>auth.cas</code> (certificate, private key, and CA certs, respectively).</p>
<h5 id="Teleport-Cloud">Teleport Cloud</h5>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tctl auth sign --user=terraform --out=terraform-identity</span></span><br></pre></td></tr></table></figure>
<p>The above sequence should result in one PEM-encoded file: <code>terraform-identity</code>.</p>
<h3 id="Step-3-4-Create-a-Terraform-configuration">Step 3/4. Create a Terraform configuration</h3>
<p>Paste the following into a file called <code>main.tf</code> to define an example user and role using Terraform.</p>
<p>Teleport Cloud</p>
<h4 id="Self-Hosted-2">Self-Hosted</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"># main.tf</span><br><span class="line"></span><br><span class="line">terraform &#123;</span><br><span class="line">  required_providers &#123;</span><br><span class="line">    teleport = &#123;</span><br><span class="line">      version = &quot;&gt;= 9.0.3&quot;</span><br><span class="line">      source  = &quot;gravitational.com/teleport/teleport&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">provider &quot;teleport&quot; &#123;</span><br><span class="line">  # Update addr to point to Teleport Auth/Proxy</span><br><span class="line">  # addr               = &quot;auth.example.com:3025&quot;</span><br><span class="line">  addr               = &quot;proxy.example.com:443&quot;</span><br><span class="line">  cert_path          = &quot;auth.crt&quot;</span><br><span class="line">  key_path           = &quot;auth.key&quot;</span><br><span class="line">  root_ca_path       = &quot;auth.cas&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">resource &quot;teleport_role&quot; &quot;terraform-test&quot; &#123;</span><br><span class="line">  metadata &#123;</span><br><span class="line">    name        = &quot;terraform-test&quot;</span><br><span class="line">    description = &quot;Terraform test role&quot;</span><br><span class="line">    labels = &#123;</span><br><span class="line">      example  = &quot;yes&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  spec &#123;</span><br><span class="line">    options &#123;</span><br><span class="line">      forward_agent           = false</span><br><span class="line">      max_session_ttl         = &quot;30m&quot;</span><br><span class="line">      port_forwarding         = false</span><br><span class="line">      client_idle_timeout     = &quot;1h&quot;</span><br><span class="line">      disconnect_expired_cert = true</span><br><span class="line">      permit_x11_forwarding    = false</span><br><span class="line">      request_access          = &quot;denied&quot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    allow &#123;</span><br><span class="line">      logins = [&quot;this-user-does-not-exist&quot;]</span><br><span class="line"></span><br><span class="line">      rules &#123;</span><br><span class="line">        resources = [&quot;user&quot;, &quot;role&quot;]</span><br><span class="line">        verbs = [&quot;list&quot;]</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      request &#123;</span><br><span class="line">        roles = [&quot;example&quot;]</span><br><span class="line">        claims_to_roles &#123;</span><br><span class="line">          claim = &quot;example&quot;</span><br><span class="line">          value = &quot;example&quot;</span><br><span class="line">          roles = [&quot;example&quot;]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      node_labels &#123;</span><br><span class="line">         key = &quot;example&quot;</span><br><span class="line">         value = [&quot;yes&quot;]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    deny &#123;</span><br><span class="line">      logins = [&quot;anonymous&quot;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">resource &quot;teleport_user&quot; &quot;terraform-test&quot; &#123;</span><br><span class="line">  metadata &#123;</span><br><span class="line">    name        = &quot;terraform-test&quot;</span><br><span class="line">    description = &quot;Test terraform user&quot;</span><br><span class="line">    expires     = &quot;2022-10-12T07:20:50.52Z&quot;</span><br><span class="line"></span><br><span class="line">    labels = &#123;</span><br><span class="line">      test      = &quot;true&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  spec &#123;</span><br><span class="line">    roles = [&quot;terraform-test&quot;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Teleport-Cloud-2">Teleport Cloud</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"># main.tf</span><br><span class="line"></span><br><span class="line">terraform &#123;</span><br><span class="line">  required_providers &#123;</span><br><span class="line">    teleport = &#123;</span><br><span class="line">      version = &quot;&gt;= 9.0.3&quot;</span><br><span class="line">      source  = &quot;gravitational.com/teleport/teleport&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">provider &quot;teleport&quot; &#123;</span><br><span class="line">  # Update addr to point to your Teleport Cloud tenant URL</span><br><span class="line">  addr               = &quot;mytenant.teleport.sh&quot;</span><br><span class="line">  identity_file_path = &quot;terraform-identity&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">resource &quot;teleport_role&quot; &quot;terraform-test&quot; &#123;</span><br><span class="line">  metadata &#123;</span><br><span class="line">    name        = &quot;terraform-test&quot;</span><br><span class="line">    description = &quot;Terraform test role&quot;</span><br><span class="line">    labels = &#123;</span><br><span class="line">      example  = &quot;yes&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  spec &#123;</span><br><span class="line">    options &#123;</span><br><span class="line">      forward_agent           = false</span><br><span class="line">      max_session_ttl         = &quot;30m&quot;</span><br><span class="line">      port_forwarding         = false</span><br><span class="line">      client_idle_timeout     = &quot;1h&quot;</span><br><span class="line">      disconnect_expired_cert = true</span><br><span class="line">      permit_x11_forwarding    = false</span><br><span class="line">      request_access          = &quot;denied&quot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    allow &#123;</span><br><span class="line">      logins = [&quot;this-user-does-not-exist&quot;]</span><br><span class="line"></span><br><span class="line">      rules &#123;</span><br><span class="line">        resources = [&quot;user&quot;, &quot;role&quot;]</span><br><span class="line">        verbs = [&quot;list&quot;]</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      request &#123;</span><br><span class="line">        roles = [&quot;example&quot;]</span><br><span class="line">        claims_to_roles &#123;</span><br><span class="line">          claim = &quot;example&quot;</span><br><span class="line">          value = &quot;example&quot;</span><br><span class="line">          roles = [&quot;example&quot;]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      node_labels &#123;</span><br><span class="line">         key = &quot;example&quot;</span><br><span class="line">         value = [&quot;yes&quot;]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    deny &#123;</span><br><span class="line">      logins = [&quot;anonymous&quot;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">resource &quot;teleport_user&quot; &quot;terraform-test&quot; &#123;</span><br><span class="line">  metadata &#123;</span><br><span class="line">    name        = &quot;terraform-test&quot;</span><br><span class="line">    description = &quot;Test terraform user&quot;</span><br><span class="line">    expires     = &quot;2022-10-12T07:20:50.52Z&quot;</span><br><span class="line"></span><br><span class="line">    labels = &#123;</span><br><span class="line">      test      = &quot;true&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  spec &#123;</span><br><span class="line">    roles = [&quot;terraform-test&quot;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Step-4-4-Apply-the-configuration">Step 4/4. Apply the configuration</h3>
<p>Check the contents of the teleport-terraform folder:</p>
<h4 id="Self-Hosted-3">Self-Hosted</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span></span></span><br><span class="line">main.tf  auth.crt  auth.key  auth.cas  terraform-impersonator.yaml  terraform.yaml</span><br></pre></td></tr></table></figure>
<h4 id="Teleport-Cloud-3">Teleport Cloud</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span></span></span><br><span class="line">main.tf  terraform-identity  terraform-impersonator.yaml  terraform.yaml</span><br></pre></td></tr></table></figure>
<p>Init terraform and apply the spec:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">terraform init</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">terraform apply</span></span><br></pre></td></tr></table></figure>
<h2 id="References">References</h2>
<p>[1] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://goteleport.com/docs/setup/guides/terraform-provider/">Terraform Provider | Teleport Docs - https://goteleport.com/docs/setup/guides/terraform-provider/</a></p>
<p>[2] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.terraform.io/">Terraform by HashiCorp - https://www.terraform.io/</a></p>
<p>[3] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://goteleport.com/">Teleport: Easiest, most secure way to access infrastructure | Teleport - https://goteleport.com/</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/bitcoin.png" alt="CloudoLife Bitcoin">
        <span>Bitcoin</span>
      </div>

  </div>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/CloudoLife" rel="external nofollow noreferrer">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://t.me/CloudoLife" rel="external nofollow noreferrer">
            <span class="icon">
              <i class="fab fa-telegram"></i>
            </span>

            <span class="label">Telegram</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/Infrastructure-as-Code-IaC/" rel="tag"># Infrastructure as Code (IaC)</a>
              <a href="/tags/Terraform/" rel="tag"># Terraform</a>
              <a href="/tags/Best-Practices/" rel="tag"># Best Practices</a>
              <a href="/tags/Security/" rel="tag"># Security</a>
              <a href="/tags/DevOps/" rel="tag"># DevOps</a>
              <a href="/tags/Teleport/" rel="tag"># Teleport</a>
              <a href="/tags/Gravitational/" rel="tag"># Gravitational</a>
              <a href="/tags/Gravitational-Teleport/" rel="tag"># Gravitational Teleport</a>
              <a href="/tags/IaC/" rel="tag"># IaC</a>
              <a href="/tags/Infrastructure-as-Code/" rel="tag"># Infrastructure as Code</a>
              <a href="/tags/tsh/" rel="tag"># tsh</a>
              <a href="/tags/Bastion/" rel="tag"># Bastion</a>
              <a href="/tags/CA/" rel="tag"># CA</a>
              <a href="/tags/Certificate-Authority/" rel="tag"># Certificate Authority</a>
              <a href="/tags/Certificate-Authority-CA/" rel="tag"># Certificate Authority (CA)</a>
              <a href="/tags/AP/" rel="tag"># AP</a>
              <a href="/tags/Access-Plane/" rel="tag"># Access Plane</a>
              <a href="/tags/Access-Plane-AP/" rel="tag"># Access Plane (AP)</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/03/26/DevOps/Gravitational-Teleport/Run-Teleport-with-Docker-Compose/" rel="prev" title="[Teleport Docker Compose] Run Teleport with Docker Compose">
                  <i class="fa fa-angle-left"></i> [Teleport Docker Compose] Run Teleport with Docker Compose
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/03/26/Apple/macOS/Running-SQL-Server-with-Docker-on-macOS/" rel="next" title="[macOS] Running SQL Server with Docker on macOS">
                  [macOS] Running SQL Server with Docker on macOS <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">CloudoLife</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">2.6m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">39:58</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener external nofollow noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener external nofollow noreferrer" target="_blank">NexT.Pisces</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"CloudoLife","repo":"col-hexo-CloudoLife.github.io","client_id":"4ca3ae8fb3a49237db9a","client_secret":"98d6652508799ef4350ab05aabe855e58f549112","admin_user":"benjamincloudolife","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":null,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"226cd7a6dda296708c1e0dd02fe6e25f"}</script>
<script src="/js/third-party/comments/gitalk.js" defer></script>

</body>
</html>
