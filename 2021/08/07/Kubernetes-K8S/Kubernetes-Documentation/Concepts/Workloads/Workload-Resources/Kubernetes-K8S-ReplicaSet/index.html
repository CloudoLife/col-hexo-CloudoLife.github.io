<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="sJgro_9-KyRL3EkTM5KW84pQPrg2Fv1KdkibDRBIulE">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"cloudolife.com","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.23.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="ReplicaSet A ReplicaSet’s purpose is to maintain a stable set of replica Pods running at any given time. As such, it is often used to guarantee the availability of a specified number of identical Pods">
<meta property="og:type" content="article">
<meta property="og:title" content="[Kubernetes (K8S) Document] Kubernetes (K8S) ReplicaSet">
<meta property="og:url" content="https://cloudolife.com/2021/08/07/Kubernetes-K8S/Kubernetes-Documentation/Concepts/Workloads/Workload-Resources/Kubernetes-K8S-ReplicaSet/index.html">
<meta property="og:site_name" content="Cloud-oriented Life">
<meta property="og:description" content="ReplicaSet A ReplicaSet’s purpose is to maintain a stable set of replica Pods running at any given time. As such, it is often used to guarantee the availability of a specified number of identical Pods">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-08-07T00:00:00.000Z">
<meta property="article:modified_time" content="2025-06-10T09:49:34.920Z">
<meta property="article:author" content="CloudoLife">
<meta property="article:tag" content="Kubernetes (K8S)">
<meta property="article:tag" content="Cloud Native">
<meta property="article:tag" content="Pod">
<meta property="article:tag" content="kubectl">
<meta property="article:tag" content="Job">
<meta property="article:tag" content="rs">
<meta property="article:tag" content="Deployment">
<meta property="article:tag" content="DaemonSet">
<meta property="article:tag" content="ReplicationController">
<meta property="article:tag" content="HPA">
<meta property="article:tag" content="Horizontal Pod Autoscaler">
<meta property="article:tag" content="Horizontal Pod Autoscaler (HPA)">
<meta property="article:tag" content="ownerReferences">
<meta property="article:tag" content="Kubernetes Document">
<meta property="article:tag" content="ReplicaSet">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://cloudolife.com/2021/08/07/Kubernetes-K8S/Kubernetes-Documentation/Concepts/Workloads/Workload-Resources/Kubernetes-K8S-ReplicaSet/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://cloudolife.com/2021/08/07/Kubernetes-K8S/Kubernetes-Documentation/Concepts/Workloads/Workload-Resources/Kubernetes-K8S-ReplicaSet/","path":"2021/08/07/Kubernetes-K8S/Kubernetes-Documentation/Concepts/Workloads/Workload-Resources/Kubernetes-K8S-ReplicaSet/","title":"[Kubernetes (K8S) Document] Kubernetes (K8S) ReplicaSet"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>[Kubernetes (K8S) Document] Kubernetes (K8S) ReplicaSet | Cloud-oriented Life</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8Y9QPJWXQN"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-8Y9QPJWXQN","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/js/third-party/analytics/google-analytics.js" defer></script>

  <script src="/js/third-party/analytics/baidu-analytics.js" defer></script>
  <script async src="https://hm.baidu.com/hm.js?995d7016a56cfd5c2ef6f2e6640a670e"></script>







  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script><script src="/js/bookmark.js" defer></script><script src="/js/pjax.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.3.1/pdfobject.min.js","integrity":"sha256-jI72I8ZLVflVOisZIOaLvRew3tyvzeu6aZXFm7P7dEo="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js" defer></script>






  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






<script data-ad-client="ca-pub-8693122033969144" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Cloud-oriented Life" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Cloud-oriented Life</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Cloud Native Technology Improves Lives</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">1646</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">331</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">584</span></a></li><li class="menu-item menu-item-ansible"><a href="/tags/Ansible/" rel="section"><i class="fa fa-book fa-fw"></i>Ansible</a></li><li class="menu-item menu-item-awesome-software"><a href="/tags/Awesome-Software/" rel="section"><i class="fa fa-book fa-fw"></i>Awesome Software</a></li><li class="menu-item menu-item-golang-(go)"><a href="/tags/Golang-Go/" rel="section"><i class="fa fa-book fa-fw"></i>Golang (Go)</a></li><li class="menu-item menu-item-helm"><a href="/tags/Helm/" rel="section"><i class="fa fa-book fa-fw"></i>Helm</a></li><li class="menu-item menu-item-java"><a href="/tags/Java/" rel="section"><i class="fa fa-book fa-fw"></i>Java</a></li><li class="menu-item menu-item-javascript"><a href="/tags/JavaScript/" rel="section"><i class="fa fa-book fa-fw"></i>JavaScript</a></li><li class="menu-item menu-item-knative"><a href="/tags/Knative/" rel="section"><i class="fa fa-book fa-fw"></i>Knative</a></li><li class="menu-item menu-item-kubernetes-(k8s)"><a href="/tags/Kubernetes-K8S/" rel="section"><i class="fa fa-book fa-fw"></i>Kubernetes (K8S)</a></li><li class="menu-item menu-item-macos"><a href="/tags/macOS/" rel="section"><i class="fa fa-book fa-fw"></i>macOS</a></li><li class="menu-item menu-item-python"><a href="/tags/Python/" rel="section"><i class="fa fa-book fa-fw"></i>Python</a></li><li class="menu-item menu-item-pulumi"><a href="/tags/Pulumi/" rel="section"><i class="fa fa-book fa-fw"></i>Pulumi</a></li><li class="menu-item menu-item-react"><a href="/tags/React/" rel="section"><i class="fa fa-book fa-fw"></i>React</a></li><li class="menu-item menu-item-ruby"><a href="/tags/Ruby/" rel="section"><i class="fa fa-book fa-fw"></i>Ruby</a></li><li class="menu-item menu-item-ruby-on-rails"><a href="/tags/Ruby-on-Rails-RoR/" rel="section"><i class="fa fa-book fa-fw"></i>Ruby On Rails</a></li><li class="menu-item menu-item-rust"><a href="/tags/Rust/" rel="section"><i class="fa fa-book fa-fw"></i>Rust</a></li><li class="menu-item menu-item-serverless"><a href="/tags/Serverless/" rel="section"><i class="fa fa-book fa-fw"></i>Serverless</a></li><li class="menu-item menu-item-service-mesh"><a href="/tags/Service-Mesh/" rel="section"><i class="fa fa-book fa-fw"></i>Service Mesh</a></li><li class="menu-item menu-item-svelte"><a href="/tags/Svelte/" rel="section"><i class="fa fa-book fa-fw"></i>Svelte</a></li><li class="menu-item menu-item-taro"><a href="/tags/Taro/" rel="section"><i class="fa fa-book fa-fw"></i>Taro</a></li><li class="menu-item menu-item-terraform"><a href="/tags/Terraform/" rel="section"><i class="fa fa-book fa-fw"></i>Terraform</a></li><li class="menu-item menu-item-typescript"><a href="/tags/TypeScript/" rel="section"><i class="fa fa-book fa-fw"></i>TypeScript</a></li><li class="menu-item menu-item-about"><a href="/about-us/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li><li class="menu-item menu-item-rss"><a href="/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>RSS</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="Searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">ReplicaSet</span></a></li><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">2.</span> <span class="nav-text">How a ReplicaSet works</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#When-to-use-a-ReplicaSet"><span class="nav-number">2.1.</span> <span class="nav-text">When to use a ReplicaSet</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Example"><span class="nav-number">2.2.</span> <span class="nav-text">Example</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Non-Template-Pod-acquisitions"><span class="nav-number">2.3.</span> <span class="nav-text">Non-Template Pod acquisitions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Writing-a-ReplicaSet-manifest"><span class="nav-number">2.4.</span> <span class="nav-text">Writing a ReplicaSet manifest</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Pod-Template"><span class="nav-number">2.4.1.</span> <span class="nav-text">Pod Template</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Pod-Selector"><span class="nav-number">2.4.2.</span> <span class="nav-text">Pod Selector</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Replicas"><span class="nav-number">2.4.3.</span> <span class="nav-text">Replicas</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Working-with-ReplicaSets"><span class="nav-number">2.5.</span> <span class="nav-text">Working with ReplicaSets</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Deleting-a-ReplicaSet-and-its-Pods"><span class="nav-number">2.5.1.</span> <span class="nav-text">Deleting a ReplicaSet and its Pods</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Deleting-just-a-ReplicaSet"><span class="nav-number">2.5.2.</span> <span class="nav-text">Deleting just a ReplicaSet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Isolating-Pods-from-a-ReplicaSet"><span class="nav-number">2.5.3.</span> <span class="nav-text">Isolating Pods from a ReplicaSet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Scaling-a-ReplicaSet"><span class="nav-number">2.5.4.</span> <span class="nav-text">Scaling a ReplicaSet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Pod-deletion-cost"><span class="nav-number">2.5.5.</span> <span class="nav-text">Pod deletion cost</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Example-Use-Case"><span class="nav-number">2.5.6.</span> <span class="nav-text">Example Use Case</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ReplicaSet-as-a-Horizontal-Pod-Autoscaler-Target"><span class="nav-number">2.5.7.</span> <span class="nav-text">ReplicaSet as a Horizontal Pod Autoscaler Target</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Alternatives-to-ReplicaSet"><span class="nav-number">2.6.</span> <span class="nav-text">Alternatives to ReplicaSet</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Deployment-recommended"><span class="nav-number">2.6.1.</span> <span class="nav-text">Deployment (recommended)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bare-Pods"><span class="nav-number">2.6.2.</span> <span class="nav-text">Bare Pods</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Job"><span class="nav-number">2.6.3.</span> <span class="nav-text">Job</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DaemonSet"><span class="nav-number">2.6.4.</span> <span class="nav-text">DaemonSet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ReplicationController"><span class="nav-number">2.6.5.</span> <span class="nav-text">ReplicationController</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#References"><span class="nav-number">2.7.</span> <span class="nav-text">References</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">CloudoLife</p>
  <div class="site-description" itemprop="description">A Husband and Father, Knowledge Worker, Full-skilled Cloud Engineer</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">584</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">331</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">1646</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/CloudoLife" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;CloudoLife" rel="noopener me external nofollow noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/CloudoLife" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;CloudoLife" rel="noopener me external nofollow noreferrer" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          Links
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://cloudolife.cn/" title="https:&#x2F;&#x2F;cloudolife.cn" rel="noopener external nofollow noreferrer" target="_blank">CLoudoLife - Chinese (Simplified)</a>
            </li>
        </ul>
      </div>
    </div>
        <div class="pjax">
        </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://cloudolife.com/2021/08/07/Kubernetes-K8S/Kubernetes-Documentation/Concepts/Workloads/Workload-Resources/Kubernetes-K8S-ReplicaSet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CloudoLife">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cloud-oriented Life">
      <meta itemprop="description" content="A Husband and Father, Knowledge Worker, Full-skilled Cloud Engineer">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="[Kubernetes (K8S) Document] Kubernetes (K8S) ReplicaSet | Cloud-oriented Life">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          [Kubernetes (K8S) Document] Kubernetes (K8S) ReplicaSet
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-08-07 00:00:00" itemprop="dateCreated datePublished" datetime="2021-08-07T00:00:00+00:00">2021-08-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-06-10 09:49:34" itemprop="dateModified" datetime="2025-06-10T09:49:34+00:00">2025-06-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Cloud-Native/" itemprop="url" rel="index"><span itemprop="name">Cloud Native</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Cloud-Native/Kubernetes-K8S/" itemprop="url" rel="index"><span itemprop="name">Kubernetes (K8S)</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Cloud-Native/Kubernetes-K8S/Kubernetes-Document/" itemprop="url" rel="index"><span itemprop="name">Kubernetes Document</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Cloud-Native/Kubernetes-K8S/Kubernetes-Document/ReplicaSet/" itemprop="url" rel="index"><span itemprop="name">ReplicaSet</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>14k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>13 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1>ReplicaSet</h1>
<p>A ReplicaSet’s purpose is to maintain a stable set of replica Pods running at any given time. As such, it is often used to guarantee the availability of a specified number of identical Pods.</p>
<span id="more"></span>
<h1>How a ReplicaSet works</h1>
<p>A ReplicaSet is defined with fields,</p>
<ul>
<li>
<p>including a selector(<code>spec.selector</code>) that specifies how to identify Pods it can acquire,</p>
</li>
<li>
<p>a number of replicas(<code>spec.replicas</code>) indicating how many Pods it should be maintaining,</p>
</li>
<li>
<p>and a pod template (<code>spec.template</code>) specifying the data of new Pods it should create to meet the number of replicas criteria.</p>
</li>
</ul>
<p>A ReplicaSet then fulfills its purpose by creating and deleting Pods as needed to reach the desired number. When a ReplicaSet needs to create new Pods, it uses its Pod template.</p>
<p>A ReplicaSet is linked to its Pods via the Pods’ <code>metadata.ownerReferences</code> field, which specifies what resource the current object is owned by. All Pods acquired by a ReplicaSet have their owning ReplicaSet’s identifying information within their <code>ownerReferences</code> field. It’s through this link that the ReplicaSet knows of the state of the Pods it is maintaining and plans accordingly.</p>
<p>A ReplicaSet identifies new Pods to acquire by using its selector. If there is a Pod that has no <code>OwnerReference</code> or the <code>OwnerReference</code> is not a Controller and it matches a ReplicaSet’s selector, it will be immediately acquired by said ReplicaSet.</p>
<h2 id="When-to-use-a-ReplicaSet">When to use a ReplicaSet</h2>
<p>A ReplicaSet ensures that a specified number of pod replicas are running at any given time. However, a Deployment is a higher-level concept that manages ReplicaSets and provides declarative updates to Pods along with a lot of other useful features.</p>
<p>Therefore, we recommend using <code>Deployments</code> instead of directly using ReplicaSets, unless you require custom update orchestration or don’t require updates at all.</p>
<p>This actually means that you may never need to manipulate ReplicaSet objects: use a Deployment instead, and define your application in the spec section.</p>
<h2 id="Example">Example</h2>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># controllers/frontend.yaml</span></span><br><span class="line"></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ReplicaSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">frontend</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">guestbook</span></span><br><span class="line">    <span class="attr">tier:</span> <span class="string">frontend</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="comment"># modify replicas according to your case</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">tier:</span> <span class="string">frontend</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">tier:</span> <span class="string">frontend</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">php-redis</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">gcr.io/google_samples/gb-frontend:v3</span></span><br></pre></td></tr></table></figure>
<p>Saving this manifest into frontend.yaml and submitting it to a Kubernetes cluster will create the defined ReplicaSet and the Pods that it manages.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl apply -f https://kubernetes.io/examples/controllers/frontend.yaml</span></span><br></pre></td></tr></table></figure>
<p>You can then get the current ReplicaSets deployed:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl get rs</span></span><br></pre></td></tr></table></figure>
<p>And see the frontend one you created:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NAME       DESIRED   CURRENT   READY   AGE</span><br><span class="line">frontend   3         3         3       6s</span><br></pre></td></tr></table></figure>
<p>You can also check on the state of the ReplicaSet:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl describe rs/frontend</span></span><br></pre></td></tr></table></figure>
<p>And you will see output similar to:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Name:         frontend</span><br><span class="line">Namespace:    default</span><br><span class="line">Selector:     tier=frontend</span><br><span class="line">Labels:       app=guestbook</span><br><span class="line">              tier=frontend</span><br><span class="line">Annotations:  kubectl.kubernetes.io/last-applied-configuration:</span><br><span class="line">                &#123;&quot;apiVersion&quot;:&quot;apps/v1&quot;,&quot;kind&quot;:&quot;ReplicaSet&quot;,&quot;metadata&quot;:&#123;&quot;annotations&quot;:&#123;&#125;,&quot;labels&quot;:&#123;&quot;app&quot;:&quot;guestbook&quot;,&quot;tier&quot;:&quot;frontend&quot;&#125;,&quot;name&quot;:&quot;frontend&quot;,...</span><br><span class="line">Replicas:     3 current / 3 desired</span><br><span class="line">Pods Status:  3 Running / 0 Waiting / 0 Succeeded / 0 Failed</span><br><span class="line">Pod Template:</span><br><span class="line">  Labels:  tier=frontend</span><br><span class="line">  Containers:</span><br><span class="line">   php-redis:</span><br><span class="line">    Image:        gcr.io/google_samples/gb-frontend:v3</span><br><span class="line">    Port:         &lt;none&gt;</span><br><span class="line">    Host Port:    &lt;none&gt;</span><br><span class="line">    Environment:  &lt;none&gt;</span><br><span class="line">    Mounts:       &lt;none&gt;</span><br><span class="line">  Volumes:        &lt;none&gt;</span><br><span class="line">Events:</span><br><span class="line">  Type    Reason            Age   From                   Message</span><br><span class="line">  ----    ------            ----  ----                   -------</span><br><span class="line">  Normal  SuccessfulCreate  117s  replicaset-controller  Created pod: frontend-wtsmm</span><br><span class="line">  Normal  SuccessfulCreate  116s  replicaset-controller  Created pod: frontend-b2zdv</span><br><span class="line">  Normal  SuccessfulCreate  116s  replicaset-controller  Created pod: frontend-vcmts</span><br></pre></td></tr></table></figure>
<p>And lastly you can check for the Pods brought up:</p>
<p>You should see Pod information similar to:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NAME             READY   STATUS    RESTARTS   AGE</span><br><span class="line">frontend-b2zdv   1/1     Running   0          6m36s</span><br><span class="line">frontend-vcmts   1/1     Running   0          6m36s</span><br><span class="line">frontend-wtsmm   1/1     Running   0          6m36s</span><br></pre></td></tr></table></figure>
<p>You can also verify that the owner reference of these pods is set to the frontend ReplicaSet. To do this, get the yaml of one of the Pods running:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl get pods frontend-b2zdv -o yaml</span></span><br></pre></td></tr></table></figure>
<p>The output will look similar to this, with the frontend ReplicaSet’s info set in the metadata’s <code>ownerReferences</code> field:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">creationTimestamp:</span> <span class="string">&quot;2020-02-12T07:06:16Z&quot;</span></span><br><span class="line">  <span class="attr">generateName:</span> <span class="string">frontend-</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">tier:</span> <span class="string">frontend</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">frontend-b2zdv</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line">  <span class="attr">ownerReferences:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line">    <span class="attr">blockOwnerDeletion:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">controller:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">kind:</span> <span class="string">ReplicaSet</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">frontend</span></span><br><span class="line">    <span class="attr">uid:</span> <span class="string">f391f6db-bb9b-4c09-ae74-6a1f77f3d5cf</span></span><br></pre></td></tr></table></figure>
<h2 id="Non-Template-Pod-acquisitions">Non-Template Pod acquisitions</h2>
<p>While you can create bare Pods with no problems, it is strongly recommended to make sure that the bare Pods do not have labels which match the selector of one of your ReplicaSets. The reason for this is because a ReplicaSet is not limited to owning Pods specified by its template-- it can acquire other Pods in the manner specified in the previous sections.</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pods/pod-rs.yaml</span></span><br><span class="line"></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod1</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">tier:</span> <span class="string">frontend</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">hello1</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">gcr.io/google-samples/hello-app:2.0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod2</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">tier:</span> <span class="string">frontend</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">hello2</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">gcr.io/google-samples/hello-app:1.0</span></span><br></pre></td></tr></table></figure>
<p>As those Pods do not have a Controller (or any object) as their owner reference and match the selector of the frontend ReplicaSet, they will immediately be acquired by it.</p>
<p>Suppose you create the Pods after the frontend ReplicaSet has been deployed and has set up its initial Pod replicas to fulfill its replica count requirement:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl apply -f https://kubernetes.io/examples/pods/pod-rs.yaml</span></span><br></pre></td></tr></table></figure>
<p>The new Pods will be acquired by the ReplicaSet, and then immediately terminated as the ReplicaSet would be over its desired count.</p>
<p>Fetching the Pods:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl get pods</span></span><br></pre></td></tr></table></figure>
<p>The output shows that the new Pods are either already terminated, or in the process of being terminated:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NAME             READY   STATUS        RESTARTS   AGE</span><br><span class="line">frontend-b2zdv   1/1     Running       0          10m</span><br><span class="line">frontend-vcmts   1/1     Running       0          10m</span><br><span class="line">frontend-wtsmm   1/1     Running       0          10m</span><br><span class="line">pod1             0/1     Terminating   0          1s</span><br><span class="line">pod2             0/1     Terminating   0          1s</span><br></pre></td></tr></table></figure>
<p>If you create the Pods first:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl apply -f https://kubernetes.io/examples/pods/pod-rs.yaml</span></span><br></pre></td></tr></table></figure>
<p>And then create the ReplicaSet however:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl apply -f https://kubernetes.io/examples/controllers/frontend.yaml</span></span><br></pre></td></tr></table></figure>
<p>You shall see that the ReplicaSet has acquired the Pods and has only created new ones according to its spec until the number of its new Pods and the original matches its desired count. As fetching the Pods:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl get pods</span></span><br></pre></td></tr></table></figure>
<p>Will reveal in its output:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NAME             READY   STATUS    RESTARTS   AGE</span><br><span class="line">frontend-hmmj2   1/1     Running   0          9s</span><br><span class="line">pod1             1/1     Running   0          36s</span><br><span class="line">pod2             1/1     Running   0          36s</span><br></pre></td></tr></table></figure>
<p>In this manner, a ReplicaSet can own a non-homogenous set of Pods</p>
<h2 id="Writing-a-ReplicaSet-manifest">Writing a ReplicaSet manifest</h2>
<p>As with all other Kubernetes API objects, a ReplicaSet needs the <code>apiVersion</code>, <code>kind</code>, and <code>metadata</code> fields. For ReplicaSets, the kind is always a ReplicaSet. In Kubernetes 1.9 the API version apps/v1 on the ReplicaSet kind is the current version and is enabled by default. The API version apps/v1beta2 is deprecated. Refer to the first lines of the <code>frontend.yaml</code> example for guidance.</p>
<p>The name of a ReplicaSet object must be a valid DNS subdomain name.</p>
<p>A ReplicaSet also needs a <code>.spec</code> section.</p>
<h3 id="Pod-Template">Pod Template</h3>
<p>The <code>.spec.template</code> is a pod template which is also required to have labels in place. In our frontend.yaml example we had one <code>label: tier: frontend</code>. Be careful not to overlap with the selectors of other controllers, lest they try to adopt this Pod.</p>
<p>For the template’s restart policy field, <code>.spec.template.spec.restartPolicy</code>, the only allowed value is Always, which is the default.</p>
<h3 id="Pod-Selector">Pod Selector</h3>
<p>The <code>.spec.selector</code> field is a label selector <a target="_blank" rel="noopener external nofollow noreferrer" href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/">Labels and Selectors | Kubernetes - https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/</a>. As discussed earlier these are the labels used to identify potential Pods to acquire. In our <code>frontend.yaml</code> example, the selector was:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">matchLabels:</span></span><br><span class="line">  <span class="attr">tier:</span> <span class="string">frontend</span></span><br></pre></td></tr></table></figure>
<p>In the ReplicaSet, <code>.spec.template.metadata.labels</code> must match <code>spec.selector</code>, or it will be rejected by the API.</p>
<hr>
<p>Note: For 2 ReplicaSets specifying the same <code>.spec.selector</code> but different <code>.spec.template.metadata.labels</code> and <code>.spec.template.spec</code> fields, each ReplicaSet ignores the Pods created by the other ReplicaSet.</p>
<hr>
<h3 id="Replicas">Replicas</h3>
<p>You can specify how many Pods should run concurrently by setting <code>.spec.replicas</code>. The ReplicaSet will create/delete its Pods to match this number.</p>
<p>If you do not specify <code>.spec.replicas</code>, then it defaults to 1.</p>
<h2 id="Working-with-ReplicaSets">Working with ReplicaSets</h2>
<h3 id="Deleting-a-ReplicaSet-and-its-Pods">Deleting a ReplicaSet and its Pods</h3>
<p>To delete a ReplicaSet and all of its Pods, use <code>kubectl delete</code>. The Garbage collector automatically deletes all of the dependent Pods by default.</p>
<p>When using the REST API or the client-go library, you must set propagationPolicy to Background or Foreground in the -d option. For example:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl proxy --port=8080</span></span><br><span class="line">curl -X DELETE  &#x27;localhost:8080/apis/apps/v1/namespaces/default/replicasets/frontend&#x27; \</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">-d <span class="string">&#x27;&#123;&quot;kind&quot;:&quot;DeleteOptions&quot;,&quot;apiVersion&quot;:&quot;v1&quot;,&quot;propagationPolicy&quot;:&quot;Foreground&quot;&#125;&#x27;</span> \</span></span><br><span class="line"><span class="language-bash">&gt; -H <span class="string">&quot;Content-Type: application/json&quot;</span></span></span><br></pre></td></tr></table></figure>
<h3 id="Deleting-just-a-ReplicaSet">Deleting just a ReplicaSet</h3>
<p>You can delete a ReplicaSet without affecting any of its Pods using kubectl delete with the <code>--cascade=orphan</code> option. When using the REST API or the client-go library, you must set <code>propagationPolicy</code> to <code>Orphan.</code> For example:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl proxy --port=8080</span></span><br><span class="line">curl -X DELETE  &#x27;localhost:8080/apis/apps/v1/namespaces/default/replicasets/frontend&#x27; \</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">-d <span class="string">&#x27;&#123;&quot;kind&quot;:&quot;DeleteOptions&quot;,&quot;apiVersion&quot;:&quot;v1&quot;,&quot;propagationPolicy&quot;:&quot;Orphan&quot;&#125;&#x27;</span> \</span></span><br><span class="line"><span class="language-bash">&gt; -H <span class="string">&quot;Content-Type: application/json&quot;</span></span></span><br></pre></td></tr></table></figure>
<p>Once the original is deleted, you can create a new ReplicaSet to replace it. As long as the old and new <code>.spec.selector</code> are the same, then the new one will adopt the old Pods.</p>
<hr>
<p>However, it will not make any effort to make existing Pods match a new, different pod template. To update Pods to a new spec in a controlled way, use a Deployment, as ReplicaSets do not support a rolling update directly.</p>
<hr>
<h3 id="Isolating-Pods-from-a-ReplicaSet">Isolating Pods from a ReplicaSet</h3>
<p>You can remove Pods from a ReplicaSet by changing their labels. This technique may be used to remove Pods from service for debugging, data recovery, etc. Pods that are removed in this way will be replaced automatically ( assuming that the number of replicas is not also changed).</p>
<h3 id="Scaling-a-ReplicaSet">Scaling a ReplicaSet</h3>
<p>A ReplicaSet can be easily scaled up or down by simply updating the .spec.replicas field. The ReplicaSet controller ensures that a desired number of Pods with a matching label selector are available and operational.</p>
<p>When scaling down, the ReplicaSet controller chooses which pods to delete by sorting the available pods to prioritize scaling down pods based on the following general algorithm:</p>
<ul>
<li>
<ol>
<li>Pending (and unschedulable) pods are scaled down first</li>
</ol>
</li>
<li>
<ol start="2">
<li>If <code>controller.kubernetes.io/pod-deletion-cost</code> annotation is set, then the pod with the lower value will come first.</li>
</ol>
</li>
<li>
<ol start="3">
<li>Pods on nodes with more replicas come before pods on nodes with fewer replicas.</li>
</ol>
</li>
<li>
<ol start="4">
<li>If the pods’ creation times differ, the pod that was created more recently comes before the older pod (the creation times are bucketed on an integer log scale when the LogarithmicScaleDown feature gate is enabled)</li>
</ol>
</li>
</ul>
<p>If all of the above match, then selection is random.</p>
<h3 id="Pod-deletion-cost">Pod deletion cost</h3>
<p><strong>FEATURE STATE:</strong> Kubernetes v1.22 [beta]</p>
<p>Using the <code>controller.kubernetes.io/pod-deletion-cost</code> annotation, users can set a preference regarding which pods to remove first when downscaling a ReplicaSet.</p>
<p>The annotation should be set on the pod, the range is [-2147483647, 2147483647]. It represents the cost of deleting a pod compared to other pods belonging to the same ReplicaSet. Pods with lower deletion cost are preferred to be deleted before pods with higher deletion cost.</p>
<p>The implicit value for this annotation for pods that don’t set it is 0; negative values are permitted. Invalid values will be rejected by the API server.</p>
<p>This feature is beta and enabled by default. You can disable it using the feature gate PodDeletionCost in both kube-apiserver and kube-controller-manager.</p>
<hr>
<p>Note:</p>
<ul>
<li>
<p>This is honored on a best-effort basis, so it does not offer any guarantees on pod deletion order.</p>
</li>
<li>
<p>Users should avoid updating the annotation frequently, such as updating it based on a metric value, because doing so will generate a significant number of pod updates on the apiserver.</p>
</li>
</ul>
<hr>
<h3 id="Example-Use-Case">Example Use Case</h3>
<p>The different pods of an application could have different utilization levels. On scale down, the application may prefer to remove the pods with lower utilization. To avoid frequently updating the pods, the application should update <a target="_blank" rel="noopener external nofollow noreferrer" href="http://controller.kubernetes.io/pod-deletion-cost">controller.kubernetes.io/pod-deletion-cost</a> once before issuing a scale down (setting the annotation to a value proportional to pod utilization level). This works if the application itself controls the down scaling; for example, the driver pod of a Spark deployment.</p>
<h3 id="ReplicaSet-as-a-Horizontal-Pod-Autoscaler-Target">ReplicaSet as a Horizontal Pod Autoscaler Target</h3>
<p>A ReplicaSet can also be a target for <a target="_blank" rel="noopener external nofollow noreferrer" href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/">Horizontal Pod Autoscalers (HPA) - https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/</a>. That is, a ReplicaSet can be auto-scaled by an HPA. Here is an example HPA targeting the ReplicaSet we created in the previous example.</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># controllers/hpa-rs.yaml</span></span><br><span class="line"></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">autoscaling/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">HorizontalPodAutoscaler</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">frontend-scaler</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">scaleTargetRef:</span></span><br><span class="line">    <span class="attr">kind:</span> <span class="string">ReplicaSet</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">frontend</span></span><br><span class="line">  <span class="attr">minReplicas:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">maxReplicas:</span> <span class="number">10</span></span><br><span class="line">  <span class="attr">targetCPUUtilizationPercentage:</span> <span class="number">50</span></span><br></pre></td></tr></table></figure>
<p>Saving this manifest into <code>hpa-rs.yaml</code> and submitting it to a Kubernetes cluster should create the defined HPA that autoscales the target ReplicaSet depending on the CPU usage of the replicated Pods.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl apply -f https://k8s.io/examples/controllers/hpa-rs.yaml</span></span><br></pre></td></tr></table></figure>
<p>Alternatively, you can use the <code>kubectl autoscale</code> command to accomplish the same (and it’s easier!)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl autoscale rs frontend --max=10 --min=3 --cpu-percent=50</span></span><br></pre></td></tr></table></figure>
<h2 id="Alternatives-to-ReplicaSet">Alternatives to ReplicaSet</h2>
<h3 id="Deployment-recommended">Deployment (recommended)</h3>
<p>Deployment is an object which can own ReplicaSets and update them and their Pods via declarative, server-side rolling updates. While ReplicaSets can be used independently, today they’re mainly used by Deployments as a mechanism to orchestrate Pod creation, deletion and updates. When you use Deployments you don’t have to worry about managing the ReplicaSets that they create. Deployments own and manage their ReplicaSets. As such, it is recommended to use Deployments when you want ReplicaSets.</p>
<h3 id="Bare-Pods">Bare Pods</h3>
<p>Unlike the case where a user directly created Pods, a ReplicaSet replaces Pods that are deleted or terminated for any reason, such as in the case of node failure or disruptive node maintenance, such as a kernel upgrade. For this reason, we recommend that you use a ReplicaSet even if your application requires only a single Pod. Think of it similarly to a process supervisor, only it supervises multiple Pods across multiple nodes instead of individual processes on a single node. A ReplicaSet delegates local container restarts to some agent on the node (for example, Kubelet or Docker).</p>
<h3 id="Job">Job</h3>
<p>Use a Job instead of a ReplicaSet for Pods that are expected to terminate on their own (that is, batch jobs).</p>
<h3 id="DaemonSet">DaemonSet</h3>
<p>Use a DaemonSet instead of a ReplicaSet for Pods that provide a machine-level function, such as machine monitoring or machine logging. These Pods have a lifetime that is tied to a machine lifetime: the Pod needs to be running on the machine before other Pods start, and are safe to terminate when the machine is otherwise ready to be rebooted/shutdown.</p>
<h3 id="ReplicationController">ReplicationController</h3>
<p>ReplicaSets are the successors to ReplicationControllers. The two serve the same purpose, and behave similarly, except that a ReplicationController does not support set-based selector requirements as described in the labels user guide. As such, ReplicaSets are preferred over ReplicationControllers</p>
<h2 id="References">References</h2>
<p>[1] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/">ReplicaSet | Kubernetes - https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/">Labels and Selectors | Kubernetes - https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/</a></p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/">Horizontal Pod Autoscaler | Kubernetes - https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/</a></p>
<p>[2] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://kubernetes.io/">Kubernetes - https://kubernetes.io/</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/bitcoin.png" alt="CloudoLife Bitcoin">
        <span>Bitcoin</span>
      </div>

  </div>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/CloudoLife" rel="external nofollow noreferrer">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://t.me/CloudoLife" rel="external nofollow noreferrer">
            <span class="icon">
              <i class="fab fa-telegram"></i>
            </span>

            <span class="label">Telegram</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/Kubernetes-K8S/" rel="tag"># Kubernetes (K8S)</a>
              <a href="/tags/Cloud-Native/" rel="tag"># Cloud Native</a>
              <a href="/tags/Pod/" rel="tag"># Pod</a>
              <a href="/tags/kubectl/" rel="tag"># kubectl</a>
              <a href="/tags/Job/" rel="tag"># Job</a>
              <a href="/tags/rs/" rel="tag"># rs</a>
              <a href="/tags/Deployment/" rel="tag"># Deployment</a>
              <a href="/tags/DaemonSet/" rel="tag"># DaemonSet</a>
              <a href="/tags/ReplicationController/" rel="tag"># ReplicationController</a>
              <a href="/tags/HPA/" rel="tag"># HPA</a>
              <a href="/tags/Horizontal-Pod-Autoscaler/" rel="tag"># Horizontal Pod Autoscaler</a>
              <a href="/tags/Horizontal-Pod-Autoscaler-HPA/" rel="tag"># Horizontal Pod Autoscaler (HPA)</a>
              <a href="/tags/ownerReferences/" rel="tag"># ownerReferences</a>
              <a href="/tags/Kubernetes-Document/" rel="tag"># Kubernetes Document</a>
              <a href="/tags/ReplicaSet/" rel="tag"># ReplicaSet</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/07/31/Programming-Language/Ruby/Talking-Rails/ActiveSupport-Delegate-module-implement-the-delegation-pattern/" rel="prev" title="[Talking-Ruby] ActiveSupport Delegate module implement the delegation pattern">
                  <i class="fa fa-angle-left"></i> [Talking-Ruby] ActiveSupport Delegate module implement the delegation pattern
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/08/07/Programming-Language/Ruby/Ruby-on-Rails-RoR/Use-ActiveSupport-Deprecation-for-deprecation-messages-in-Rails/" rel="next" title="[Ruby on Rails (RoR)] Use ActiveSupport::Deprecation for deprecation messages in Rails">
                  [Ruby on Rails (RoR)] Use ActiveSupport::Deprecation for deprecation messages in Rails <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">CloudoLife</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">2.6m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">39:58</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener external nofollow noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener external nofollow noreferrer" target="_blank">NexT.Pisces</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"CloudoLife","repo":"col-hexo-CloudoLife.github.io","client_id":"4ca3ae8fb3a49237db9a","client_secret":"98d6652508799ef4350ab05aabe855e58f549112","admin_user":"benjamincloudolife","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":null,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"411086084c87e5943146ff2bbd9c0245"}</script>
<script src="/js/third-party/comments/gitalk.js" defer></script>

</body>
</html>
