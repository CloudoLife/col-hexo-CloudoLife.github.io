<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="sJgro_9-KyRL3EkTM5KW84pQPrg2Fv1KdkibDRBIulE">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"cloudolife.com","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.23.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="parser Parser is a production-ready Ruby parser written in pure Ruby. It recognizes as much or more code than Ripper, Melbourne, JRubyParser or ruby_parser, and is vastly more convenient to use.">
<meta property="og:type" content="article">
<meta property="og:title" content="[Awesome Ruby Gem - Abstract Syntax Tree (AST)] Use parser gem to parse Abstract Syntax Tree (AST) in Ruby">
<meta property="og:url" content="https://cloudolife.com/2021/07/31/Programming-Language/Ruby/Awesome-Ruby-Gem/Abstract-Syntax-Tree-AST/Use-parser-gem-to-parse-Abstract-Syntax-Tree-AST-in-Ruby/index.html">
<meta property="og:site_name" content="Cloud-oriented Life">
<meta property="og:description" content="parser Parser is a production-ready Ruby parser written in pure Ruby. It recognizes as much or more code than Ripper, Melbourne, JRubyParser or ruby_parser, and is vastly more convenient to use.">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-07-31T00:00:00.000Z">
<meta property="article:modified_time" content="2025-06-10T09:49:34.933Z">
<meta property="article:author" content="CloudoLife">
<meta property="article:tag" content="Best Practices">
<meta property="article:tag" content="Ruby">
<meta property="article:tag" content="Programming Language">
<meta property="article:tag" content="Awesome Ruby Gem">
<meta property="article:tag" content="parser">
<meta property="article:tag" content="unparser">
<meta property="article:tag" content="AST">
<meta property="article:tag" content="Sexp">
<meta property="article:tag" content="Ripper">
<meta property="article:tag" content="Abstract Syntax Tree (AST)">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://cloudolife.com/2021/07/31/Programming-Language/Ruby/Awesome-Ruby-Gem/Abstract-Syntax-Tree-AST/Use-parser-gem-to-parse-Abstract-Syntax-Tree-AST-in-Ruby/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://cloudolife.com/2021/07/31/Programming-Language/Ruby/Awesome-Ruby-Gem/Abstract-Syntax-Tree-AST/Use-parser-gem-to-parse-Abstract-Syntax-Tree-AST-in-Ruby/","path":"2021/07/31/Programming-Language/Ruby/Awesome-Ruby-Gem/Abstract-Syntax-Tree-AST/Use-parser-gem-to-parse-Abstract-Syntax-Tree-AST-in-Ruby/","title":"[Awesome Ruby Gem - Abstract Syntax Tree (AST)] Use parser gem to parse Abstract Syntax Tree (AST) in Ruby"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>[Awesome Ruby Gem - Abstract Syntax Tree (AST)] Use parser gem to parse Abstract Syntax Tree (AST) in Ruby | Cloud-oriented Life</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8Y9QPJWXQN"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"G-8Y9QPJWXQN","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/js/third-party/analytics/google-analytics.js" defer></script>

  <script src="/js/third-party/analytics/baidu-analytics.js" defer></script>
  <script async src="https://hm.baidu.com/hm.js?995d7016a56cfd5c2ef6f2e6640a670e"></script>







  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script><script src="/js/bookmark.js" defer></script><script src="/js/pjax.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>

  <script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.3.1/pdfobject.min.js","integrity":"sha256-jI72I8ZLVflVOisZIOaLvRew3tyvzeu6aZXFm7P7dEo="},"url":"/lib/pdf/web/viewer.html"}</script>
  <script src="/js/third-party/tags/pdf.js" defer></script>






  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>






<script data-ad-client="ca-pub-8693122033969144" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Cloud-oriented Life" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Cloud-oriented Life</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Cloud Native Technology Improves Lives</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">1646</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">331</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">584</span></a></li><li class="menu-item menu-item-ansible"><a href="/tags/Ansible/" rel="section"><i class="fa fa-book fa-fw"></i>Ansible</a></li><li class="menu-item menu-item-awesome-software"><a href="/tags/Awesome-Software/" rel="section"><i class="fa fa-book fa-fw"></i>Awesome Software</a></li><li class="menu-item menu-item-golang-(go)"><a href="/tags/Golang-Go/" rel="section"><i class="fa fa-book fa-fw"></i>Golang (Go)</a></li><li class="menu-item menu-item-helm"><a href="/tags/Helm/" rel="section"><i class="fa fa-book fa-fw"></i>Helm</a></li><li class="menu-item menu-item-java"><a href="/tags/Java/" rel="section"><i class="fa fa-book fa-fw"></i>Java</a></li><li class="menu-item menu-item-javascript"><a href="/tags/JavaScript/" rel="section"><i class="fa fa-book fa-fw"></i>JavaScript</a></li><li class="menu-item menu-item-knative"><a href="/tags/Knative/" rel="section"><i class="fa fa-book fa-fw"></i>Knative</a></li><li class="menu-item menu-item-kubernetes-(k8s)"><a href="/tags/Kubernetes-K8S/" rel="section"><i class="fa fa-book fa-fw"></i>Kubernetes (K8S)</a></li><li class="menu-item menu-item-macos"><a href="/tags/macOS/" rel="section"><i class="fa fa-book fa-fw"></i>macOS</a></li><li class="menu-item menu-item-python"><a href="/tags/Python/" rel="section"><i class="fa fa-book fa-fw"></i>Python</a></li><li class="menu-item menu-item-pulumi"><a href="/tags/Pulumi/" rel="section"><i class="fa fa-book fa-fw"></i>Pulumi</a></li><li class="menu-item menu-item-react"><a href="/tags/React/" rel="section"><i class="fa fa-book fa-fw"></i>React</a></li><li class="menu-item menu-item-ruby"><a href="/tags/Ruby/" rel="section"><i class="fa fa-book fa-fw"></i>Ruby</a></li><li class="menu-item menu-item-ruby-on-rails"><a href="/tags/Ruby-on-Rails-RoR/" rel="section"><i class="fa fa-book fa-fw"></i>Ruby On Rails</a></li><li class="menu-item menu-item-rust"><a href="/tags/Rust/" rel="section"><i class="fa fa-book fa-fw"></i>Rust</a></li><li class="menu-item menu-item-serverless"><a href="/tags/Serverless/" rel="section"><i class="fa fa-book fa-fw"></i>Serverless</a></li><li class="menu-item menu-item-service-mesh"><a href="/tags/Service-Mesh/" rel="section"><i class="fa fa-book fa-fw"></i>Service Mesh</a></li><li class="menu-item menu-item-svelte"><a href="/tags/Svelte/" rel="section"><i class="fa fa-book fa-fw"></i>Svelte</a></li><li class="menu-item menu-item-taro"><a href="/tags/Taro/" rel="section"><i class="fa fa-book fa-fw"></i>Taro</a></li><li class="menu-item menu-item-terraform"><a href="/tags/Terraform/" rel="section"><i class="fa fa-book fa-fw"></i>Terraform</a></li><li class="menu-item menu-item-typescript"><a href="/tags/TypeScript/" rel="section"><i class="fa fa-book fa-fw"></i>TypeScript</a></li><li class="menu-item menu-item-about"><a href="/about-us/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li><li class="menu-item menu-item-rss"><a href="/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>RSS</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="Searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">parser</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Features"><span class="nav-number">1.1.</span> <span class="nav-text">Features</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Installation"><span class="nav-number">1.2.</span> <span class="nav-text">Installation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Usage"><span class="nav-number">1.3.</span> <span class="nav-text">Usage</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Documentation"><span class="nav-number">1.4.</span> <span class="nav-text">Documentation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Node-names"><span class="nav-number">1.4.1.</span> <span class="nav-text">Node names</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#block"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">(block)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#begin-and-kwbegin"><span class="nav-number">1.4.1.2.</span> <span class="nav-text">(begin) and (kwbegin)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#References"><span class="nav-number">1.5.</span> <span class="nav-text">References</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">CloudoLife</p>
  <div class="site-description" itemprop="description">A Husband and Father, Knowledge Worker, Full-skilled Cloud Engineer</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">584</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">331</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">1646</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/CloudoLife" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;CloudoLife" rel="noopener me external nofollow noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/CloudoLife" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;CloudoLife" rel="noopener me external nofollow noreferrer" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          Links
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://cloudolife.cn/" title="https:&#x2F;&#x2F;cloudolife.cn" rel="noopener external nofollow noreferrer" target="_blank">CLoudoLife - Chinese (Simplified)</a>
            </li>
        </ul>
      </div>
    </div>
        <div class="pjax">
        </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://cloudolife.com/2021/07/31/Programming-Language/Ruby/Awesome-Ruby-Gem/Abstract-Syntax-Tree-AST/Use-parser-gem-to-parse-Abstract-Syntax-Tree-AST-in-Ruby/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CloudoLife">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cloud-oriented Life">
      <meta itemprop="description" content="A Husband and Father, Knowledge Worker, Full-skilled Cloud Engineer">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="[Awesome Ruby Gem - Abstract Syntax Tree (AST)] Use parser gem to parse Abstract Syntax Tree (AST) in Ruby | Cloud-oriented Life">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          [Awesome Ruby Gem - Abstract Syntax Tree (AST)] Use parser gem to parse Abstract Syntax Tree (AST) in Ruby
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-07-31 00:00:00" itemprop="dateCreated datePublished" datetime="2021-07-31T00:00:00+00:00">2021-07-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2025-06-10 09:49:34" itemprop="dateModified" datetime="2025-06-10T09:49:34+00:00">2025-06-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Programming-Language/" itemprop="url" rel="index"><span itemprop="name">Programming Language</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Programming-Language/Ruby/" itemprop="url" rel="index"><span itemprop="name">Ruby</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Programming-Language/Ruby/Awesome-Ruby-Gem/" itemprop="url" rel="index"><span itemprop="name">Awesome Ruby Gem</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Programming-Language/Ruby/Awesome-Ruby-Gem/Abstract-Syntax-Tree-AST/" itemprop="url" rel="index"><span itemprop="name">Abstract Syntax Tree (AST)</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>5.8k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>5 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1>parser</h1>
<p>Parser is a production-ready Ruby parser written in pure Ruby. It recognizes as much or more code than Ripper, Melbourne, JRubyParser or ruby_parser, and is vastly more convenient to use.</p>
<span id="more"></span>
<p>You can also use unparser <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/mbj/unparser">mbj/unparser: Turn Ruby AST into semantically equivalent Ruby source - https://github.com/mbj/unparser</a> to produce equivalent source code from Parser’s ASTs.</p>
<h2 id="Features">Features</h2>
<ul>
<li>
<p>Precise source location reporting.</p>
</li>
<li>
<p>Documented AST format which is convenient to work with.</p>
</li>
<li>
<p>A simple interface and a powerful, tweakable one.</p>
</li>
<li>
<p>Parses 1.8, 1.9, 2.0, 2.1, 2.2 and 2.3 syntax with backwards-compatible AST formats.</p>
</li>
<li>
<p>Parses MacRuby and RubyMotion syntax extensions.</p>
</li>
<li>
<p>Rewriting support.</p>
</li>
<li>
<p>Parsing error recovery.</p>
</li>
<li>
<p>Improved clang-like diagnostic messages with location information.</p>
</li>
<li>
<p>Written in pure Ruby, runs on MRI &gt;=2.0.0, JRuby and Rubinius (and historically, all versions of Ruby since 1.8)</p>
</li>
<li>
<p>Only one runtime dependency: the <code>ast</code> gem.</p>
</li>
<li>
<p>Insane Ruby lexer rewritten from scratch in Ragel.</p>
</li>
<li>
<p>100% test coverage for Bison grammars (except error recovery).</p>
</li>
<li>
<p>Readable, commented source code.</p>
</li>
</ul>
<h2 id="Installation">Installation</h2>
<p>You can install it as a gem:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">gem install parser</span></span><br></pre></td></tr></table></figure>
<p>or add it into a Gemfile (Bundler):</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Gemfile</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># whitequark/parser: A Ruby parser.</span></span><br><span class="line"><span class="comment"># https://github.com/whitequark/parser</span></span><br><span class="line">gem <span class="string">&#x27;parser&#x27;</span>, <span class="string">&#x27;3.0.2.0&#x27;</span></span><br></pre></td></tr></table></figure>
<p>Then, run <code>bundle install</code>.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">bundle install</span></span><br></pre></td></tr></table></figure>
<h2 id="Usage">Usage</h2>
<p>Load Parser (see the backwards compatibility section below for explanation of <code>emit_*</code> calls):</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">&#x27;parser/current&#x27;</span></span><br><span class="line"><span class="comment"># opt-in to most recent AST format:</span></span><br><span class="line"><span class="title class_">Parser</span><span class="symbol">:</span><span class="symbol">:Builders</span><span class="symbol">:</span><span class="symbol">:Default</span>.emit_lambda              = <span class="literal">true</span></span><br><span class="line"><span class="title class_">Parser</span><span class="symbol">:</span><span class="symbol">:Builders</span><span class="symbol">:</span><span class="symbol">:Default</span>.emit_procarg0            = <span class="literal">true</span></span><br><span class="line"><span class="title class_">Parser</span><span class="symbol">:</span><span class="symbol">:Builders</span><span class="symbol">:</span><span class="symbol">:Default</span>.emit_encoding            = <span class="literal">true</span></span><br><span class="line"><span class="title class_">Parser</span><span class="symbol">:</span><span class="symbol">:Builders</span><span class="symbol">:</span><span class="symbol">:Default</span>.emit_index               = <span class="literal">true</span></span><br><span class="line"><span class="title class_">Parser</span><span class="symbol">:</span><span class="symbol">:Builders</span><span class="symbol">:</span><span class="symbol">:Default</span>.emit_arg_inside_procarg0 = <span class="literal">true</span></span><br><span class="line"><span class="title class_">Parser</span><span class="symbol">:</span><span class="symbol">:Builders</span><span class="symbol">:</span><span class="symbol">:Default</span>.emit_forward_arg         = <span class="literal">true</span></span><br><span class="line"><span class="title class_">Parser</span><span class="symbol">:</span><span class="symbol">:Builders</span><span class="symbol">:</span><span class="symbol">:Default</span>.emit_kwargs              = <span class="literal">true</span></span><br><span class="line"><span class="title class_">Parser</span><span class="symbol">:</span><span class="symbol">:Builders</span><span class="symbol">:</span><span class="symbol">:Default</span>.emit_match_pattern       = <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>Parse a chunk of code:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p <span class="title class_">Parser</span><span class="symbol">:</span><span class="symbol">:CurrentRuby</span>.parse(<span class="string">&quot;2 + 2&quot;</span>)</span><br><span class="line"><span class="comment"># (send</span></span><br><span class="line"><span class="comment">#   (int 2) :+</span></span><br><span class="line"><span class="comment">#   (int 2))</span></span><br></pre></td></tr></table></figure>
<p>Access the AST’s source map:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">p <span class="title class_">Parser</span><span class="symbol">:</span><span class="symbol">:CurrentRuby</span>.parse(<span class="string">&quot;2 + 2&quot;</span>).loc</span><br><span class="line"><span class="comment"># #&lt;Parser::Source::Map::Send:0x007fe5a1ac2388</span></span><br><span class="line"><span class="comment">#   <span class="doctag">@dot</span>=nil,</span></span><br><span class="line"><span class="comment">#   <span class="doctag">@begin</span>=nil,</span></span><br><span class="line"><span class="comment">#   <span class="doctag">@end</span>=nil,</span></span><br><span class="line"><span class="comment">#   <span class="doctag">@selector</span>=#&lt;Source::Range (string) 2...3&gt;,</span></span><br><span class="line"><span class="comment">#   <span class="doctag">@expression</span>=#&lt;Source::Range (string) 0...5&gt;&gt;</span></span><br><span class="line"></span><br><span class="line">p <span class="title class_">Parser</span><span class="symbol">:</span><span class="symbol">:CurrentRuby</span>.parse(<span class="string">&quot;2 + 2&quot;</span>).loc.selector.source</span><br><span class="line"><span class="comment"># &quot;+&quot;</span></span><br></pre></td></tr></table></figure>
<p>Traverse the <code>AST:</code> see the documentation for gem ast.</p>
<p>Parse a chunk of code and display all diagnostics:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">parser = <span class="title class_">Parser</span><span class="symbol">:</span><span class="symbol">:CurrentRuby</span>.new</span><br><span class="line">parser.diagnostics.consumer = <span class="built_in">lambda</span> <span class="keyword">do</span> |<span class="params">diag</span>|</span><br><span class="line">  puts diag.render</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">buffer = <span class="title class_">Parser::Source::Buffer</span>.new(<span class="string">&#x27;(string)&#x27;</span>, <span class="symbol">source:</span> <span class="string">&quot;foo *bar&quot;</span>)</span><br><span class="line"></span><br><span class="line">p parser.parse(buffer)</span><br><span class="line"><span class="comment"># (string):1:5: warning: `*&#x27; interpreted as argument prefix</span></span><br><span class="line"><span class="comment"># foo *bar</span></span><br><span class="line"><span class="comment">#     ^</span></span><br><span class="line"><span class="comment"># (send nil :foo</span></span><br><span class="line"><span class="comment">#   (splat</span></span><br><span class="line"><span class="comment">#     (send nil :bar)))</span></span><br></pre></td></tr></table></figure>
<p>If you reuse the same parser object for multiple <code>#parse</code> runs, you need to <code>#reset</code> it.</p>
<p>You can also use the <code>ruby-parse</code> utility (it’s bundled with the gem) to play with Parser:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ruby-parse -L -e <span class="string">&quot;2+2&quot;</span></span></span><br><span class="line">(send</span><br><span class="line">  (int 2) :+</span><br><span class="line">  (int 2))</span><br><span class="line">2+2</span><br><span class="line"> ~ selector</span><br><span class="line">~~~ expression</span><br><span class="line">(int 2)</span><br><span class="line">2+2</span><br><span class="line">~ expression</span><br><span class="line">(int 2)</span><br><span class="line">2+2</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ruby-parse -E -e <span class="string">&quot;2+2&quot;</span></span></span><br><span class="line">2+2</span><br><span class="line">^ tINTEGER 2                                    expr_end     [0 &lt;= cond] [0 &lt;= cmdarg]</span><br><span class="line">2+2</span><br><span class="line"> ^ tPLUS &quot;+&quot;                                    expr_beg     [0 &lt;= cond] [0 &lt;= cmdarg]</span><br><span class="line">2+2</span><br><span class="line">  ^ tINTEGER 2                                  expr_end     [0 &lt;= cond] [0 &lt;= cmdarg]</span><br><span class="line">2+2</span><br><span class="line">  ^ false &quot;$eof&quot;                                expr_end     [0 &lt;= cond] [0 &lt;= cmdarg]</span><br><span class="line">(send</span><br><span class="line">  (int 2) :+</span><br><span class="line">  (int 2))</span><br></pre></td></tr></table></figure>
<h2 id="Documentation">Documentation</h2>
<p>Documentation for Parser is available online <a target="_blank" rel="noopener external nofollow noreferrer" href="https://whitequark.github.io/parser/">File: README — Documentation by YARD 0.8.7.4 - https://whitequark.github.io/parser/</a><br>
.</p>
<h3 id="Node-names">Node names</h3>
<p>Several Parser nodes seem to be confusing enough to warrant a dedicated README section.</p>
<h4 id="block">(block)</h4>
<p>The (block) node passes a Ruby block, that is, a closure, to a method call represented by its first child, a (send), (super) or (zsuper) node. To demonstrate:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ruby-parse -e <span class="string">&#x27;foo &#123; |x| x + 2 &#125;&#x27;</span></span></span><br><span class="line">(block</span><br><span class="line">  (send nil :foo)</span><br><span class="line">  (args</span><br><span class="line">    (arg :x))</span><br><span class="line">  (send</span><br><span class="line">    (lvar :x) :+</span><br><span class="line">    (int 2)))</span><br></pre></td></tr></table></figure>
<h4 id="begin-and-kwbegin">(begin) and (kwbegin)</h4>
<p>TL;DR: Unless you perform rewriting, treat (begin) and (kwbegin) as the same node type.</p>
<p>Both (begin) and (kwbegin) nodes represent compound statements, that is, several expressions which are executed sequentally and the value of the last one is the value of entire compound statement. They may take several forms in the source code:</p>
<ul>
<li>
<p>foo; bar: without delimiters</p>
</li>
<li>
<p>(foo; bar): parenthesized</p>
</li>
<li>
<p>begin foo; bar; end: grouped with begin keyword</p>
</li>
<li>
<p>def x; foo; bar; end: grouped inside a method definition</p>
</li>
</ul>
<p>and so on.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ruby-parse -e <span class="string">&#x27;(foo; bar)&#x27;</span></span></span><br><span class="line">(begin</span><br><span class="line">  (send nil :foo)</span><br><span class="line">  (send nil :bar))</span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ruby-parse -e <span class="string">&#x27;def x; foo; bar end&#x27;</span></span></span><br><span class="line">(def :x</span><br><span class="line">  (args)</span><br><span class="line">  (begin</span><br><span class="line">    (send nil :foo)</span><br><span class="line">    (send nil :bar)))</span><br></pre></td></tr></table></figure>
<p>Note that, despite its name, kwbegin node only has tangential relation to the begin keyword. Normally, Parser AST is semantic, that is, if two constructs look differently but behave identically, they get parsed to the same node. However, there exists a peculiar construct called post-loop in Ruby:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">begin</span><br><span class="line">  body</span><br><span class="line">end while condition</span><br></pre></td></tr></table></figure>
<p>This specific syntactic construct, that is, keyword begin…end block followed by a postfix while, behaves very unlike other similar constructs, e.g. (body) while condition. While the body itself is wrapped into a while-post node, Parser also supports rewriting, and in that context it is important to not accidentally convert one kind of loop into another.</p>
<pre><code class="language-shell">$ ruby-parse -e 'begin foo end while cond'
(while-post
  (send nil :cond)
  (kwbegin
    (send nil :foo)))
$ ruby-parse -e 'foo while cond'
(while
  (send nil :cond)
  (send nil :foo))
$ ruby-parse -e '(foo) while cond'
(while
  (send nil :cond)
  (begin
    (send nil :foo)))
</code></pre>
<p>(Parser also needs the (kwbegin) node type internally, and it is highly problematic to map it back to (begin).)</p>
<h2 id="References">References</h2>
<p>[1] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/whitequark/parser">whitequark/parser: A Ruby parser. - https://github.com/whitequark/parser</a></p>
<p>[2] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://rubygems.org/gems/parser">parser | RubyGems.org | your community gem host - https://rubygems.org/gems/parser</a></p>
<p>[3] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://whitequark.github.io/parser/">File: README — Documentation by YARD 0.8.7.4 - https://whitequark.github.io/parser/</a></p>
<p>[4] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://whitequark.github.io/ast/AST/Sexp.html">Module: AST::Sexp — Documentation by YARD 0.9.12 - https://whitequark.github.io/ast/AST/Sexp.html</a></p>
<p>[5] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.rubyguides.com/2015/08/static-analysis-in-ruby/">Static Analysis in Ruby - RubyGuides - https://www.rubyguides.com/2015/08/static-analysis-in-ruby/</a></p>
<p>[6] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.arkency.com/using-ruby-parser-and-ast-tree-to-find-deprecated-syntax/">Using ruby parser and AST tree to find deprecated syntax | Arkency Blog - https://blog.arkency.com/using-ruby-parser-and-ast-tree-to-find-deprecated-syntax/</a></p>
<p>[7] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/mbj/unparser">mbj/unparser: Turn Ruby AST into semantically equivalent Ruby source - https://github.com/mbj/unparser</a></p>
<p>[8] <a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.ruby-lang.org/en/3.0.0/Ripper.html">class Ripper - Documentation for Ruby 3.0.0 - https://docs.ruby-lang.org/en/3.0.0/Ripper.html</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/bitcoin.png" alt="CloudoLife Bitcoin">
        <span>Bitcoin</span>
      </div>

  </div>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/CloudoLife" rel="external nofollow noreferrer">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://t.me/CloudoLife" rel="external nofollow noreferrer">
            <span class="icon">
              <i class="fab fa-telegram"></i>
            </span>

            <span class="label">Telegram</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/Best-Practices/" rel="tag"># Best Practices</a>
              <a href="/tags/Ruby/" rel="tag"># Ruby</a>
              <a href="/tags/Programming-Language/" rel="tag"># Programming Language</a>
              <a href="/tags/Awesome-Ruby-Gem/" rel="tag"># Awesome Ruby Gem</a>
              <a href="/tags/parser/" rel="tag"># parser</a>
              <a href="/tags/unparser/" rel="tag"># unparser</a>
              <a href="/tags/AST/" rel="tag"># AST</a>
              <a href="/tags/Sexp/" rel="tag"># Sexp</a>
              <a href="/tags/Ripper/" rel="tag"># Ripper</a>
              <a href="/tags/Abstract-Syntax-Tree-AST/" rel="tag"># Abstract Syntax Tree (AST)</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/07/31/Programming-Language/Ruby/Awesome-Ruby-Gem/Abstract-Syntax-Tree-AST/Use-unparser-gem-to-produce-equivalent-source-code-from-Parser-s-ASTs/" rel="prev" title="[Awesome Ruby Gem - Abstract Syntax Tree (AST)] Use unparser gem to produce equivalent source code from Parser&#39;s ASTs">
                  <i class="fa fa-angle-left"></i> [Awesome Ruby Gem - Abstract Syntax Tree (AST)] Use unparser gem to produce equivalent source code from Parser's ASTs
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/07/31/Programming-Language/Ruby/Talking-Ruby/SimpleDelegator-A-concrete-implementation-of-Delegator-in-Ruby/" rel="next" title="[Talking-Ruby] SimpleDelegator: A concrete implementation of Delegator in Ruby">
                  [Talking-Ruby] SimpleDelegator: A concrete implementation of Delegator in Ruby <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">CloudoLife</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">2.6m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">39:58</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener external nofollow noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener external nofollow noreferrer" target="_blank">NexT.Pisces</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"CloudoLife","repo":"col-hexo-CloudoLife.github.io","client_id":"4ca3ae8fb3a49237db9a","client_secret":"98d6652508799ef4350ab05aabe855e58f549112","admin_user":"benjamincloudolife","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":null,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"0711adad0991e5a1fc49e6951446a302"}</script>
<script src="/js/third-party/comments/gitalk.js" defer></script>

</body>
</html>
